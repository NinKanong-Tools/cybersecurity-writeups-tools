# WHOIS Lookup


### What is WHOIS Lookup?
WHOIS lookup is a query process used to retrieve information about a registered domain name, IP address, or autonomous system from a WHOIS database. The WHOIS protocol (defined in RFC 3912) allows users to access public records maintained by domain registrars and regional internet registries (RIRs). These records contain details about the ownership, registration, and technical configuration of internet resources.

### A WHOIS lookup typically returns:

Domain Information:

- Domain Name: The registered domain (e.g., example.com).
- Registrant Details: Name, organization, and contact information of the domain owner (often redacted for privacy due to regulations like GDPR).
- Registrar: The company or organization that registered the domain (e.g., GoDaddy, Namecheap).
- Name Servers: The servers handling DNS queries for the domain.
- Registration Dates: Creation, last update, and expiration dates.
- Domain Status: Codes indicating restrictions (e.g., clientTransferProhibited).

IP Address Information:

- Organization: The entity assigned the IP (e.g., Google LLC for 8.8.8.8).
- Net Range/CIDR: The IP range or subnet the address belongs to.
- Abuse Contact: Email or phone for reporting abuse.
- Geolocation: Sometimes included, depending on the registry.

## WHOIS LOOKUP Commandline

### 1. Get help
```
whois -h
```
<img width="618" height="222" alt="image" src="https://github.com/user-attachments/assets/4399be2d-d9a8-4d94-a1df-c28e43aaed72" />

### 2. Basic WHOIS Command Syntax
- Query a domain
```
whois google.com
```
<img width="721" height="423" alt="image" src="https://github.com/user-attachments/assets/2f43dca8-044b-42e0-a94d-774bdc047d4b" />

This returns full registration info for Google.

- query an IP Address
```
whois 8.8.8.8
```
<img width="565" height="415" alt="image" src="https://github.com/user-attachments/assets/b5edc6f0-56b6-412e-b36f-a06d8ea5c6d8" />

This shows that Google owns this IP (part of Google Public DNS). 

=> Explain when we key fields:
- Domain Name :    The domain being queried
- Registrar:     Company that registered the domain
- Whois Server:     Which server holds the full record
- Name server:      DNS servers for the domain
- Creation/Expiration Date:      When domain was registered and when it expires
- Registrant:      Owner of the domain
- Status:       security locks

### 3. Clean Output
```
whois -H google.com
```
<img width="725" height="424" alt="image" src="https://github.com/user-attachments/assets/069e3be9-25a9-49d9-8b41-89e4a09cfdec" />

It removes long legal text at the end.
- H : Hide legal disclaimers (cleaner output).

### 4. query a specific WHOIS server
```
whois -h whois.markmonitor.com google.com
```
<img width="780" height="498" alt="image" src="https://github.com/user-attachments/assets/641149f4-8868-483a-9d0e-4bdfcf26267b" />

<img width="532" height="193" alt="image" src="https://github.com/user-attachments/assets/cbe110ed-9283-48a6-89af-0b65b168909f" />

Forces query to Googleâ€™s registrar server. 
-h {server} : Query a specific WHOIS server.

### 5. Recursive Lookup
```
whois -l - H 8.8.8.8
```
<img width="550" height="241" alt="image" src="https://github.com/user-attachments/assets/6765bcdc-39c1-4cfc-9e32-831b984f058d" />

<img width="627" height="413" alt="image" src="https://github.com/user-attachments/assets/260e8560-8e25-421a-a184-a684532a6c8f" />

Follows referrals to get full ownership chain. 
-l : Follow referral chain (recursive lookup).

### 6. Query ARIN (IP infomation)
```
whois -a 8.8.8.8
```
<img width="579" height="316" alt="image" src="https://github.com/user-attachments/assets/b9328a69-e0e8-43fb-8199-7b9c4a7c4ce8" />

Forces query to ARIN (American Registry). 

### 7. Check Domain Availability
```
whois thisdomaindoesnotexist12345.com
```
<img width="524" height="87" alt="image" src="https://github.com/user-attachments/assets/9a14d8ae-dbf3-4d9c-b8a3-a427a070f31f" />

Means it might be available for registration.

- Note: WHOIS data sources

=> RIR  - Region - Whois Server
```
ARIN North  :  America : whois.arin.net
RIPE : Europe, Middle : East whois.ripe.net
APNIC : Asia-Pacific : whois.apnic.net
LACNIC : Latin America : whois.lacnic.net
AFRINIC : Africa : whois.afrinic.net
```

### 8. Query directly
```
whois -h whois.ripe.net 2.2.2.2
```
<img width="637" height="425" alt="image" src="https://github.com/user-attachments/assets/9118338a-a798-4cc1-9a07-170944d6f1eb" />


### 9. Recon use cases
- Case 1: footprinting a Target
```
whois target-site.com
```
<img width="727" height="322" alt="image" src="https://github.com/user-attachments/assets/f8ed9a6e-7d98-45bb-8282-73263f64c1e5" />

It use before attacking a system, gather info.

```
whois -h whois.iana.org target-site.com
```
<img width="482" height="399" alt="image" src="https://github.com/user-attachments/assets/88394efe-8791-4dd4-8ec9-56662758bfe3" />

Advanced Query: Specify a server if needed.

- Case 2: Reverse IP lookup
```
whois 104.18.20.10
```
<img width="772" height="455" alt="image" src="https://github.com/user-attachments/assets/5e1fb563-7a21-4a24-a2fb-384e72c256da" />

 May reveal it's Cloudflare, AWS, or a hosting company. 


- Case 3: Identify Related Domains
```
whois -H amazon.com
```
<img width="724" height="499" alt="image" src="https://github.com/user-attachments/assets/b0a8dfac-eddb-44f8-ab6a-2ac9c0d5c124" />

Then search for other domains registered by the same email/org. 


### 10. Automate WHOIS Queries with Bash Script

```
nano whois.sh
```
<img width="184" height="54" alt="image" src="https://github.com/user-attachments/assets/8d565b00-3e84-4f74-8fdb-796afcc1155a" />

```
#!/bin/bash
# File: whois.sh
# Usage: chmod +x whois.sh && ./whois.sh

domains=("google.com" "facebook.com" "nmap.org")

for domain in "${domains[@]}"; do
    echo " WHOIS for $domain"
    echo "----------------------------------------"
    whois -H "$domain" | grep -i "Creation\|Expiry\|Registrar\|Name Server"
    echo ""
done

```
<img width="644" height="218" alt="image" src="https://github.com/user-attachments/assets/919472bd-03e6-4523-b267-8967031dbafc" />

```
chmod +x whois.sh
```
<img width="205" height="55" alt="image" src="https://github.com/user-attachments/assets/8e0ca48e-c05a-417d-aee3-082849f0650e" />

```
./whois.sh
```
<img width="610" height="509" alt="image" src="https://github.com/user-attachments/assets/971d4e0b-536b-47d6-9bb2-3ae4b39d527b" />

<img width="657" height="559" alt="image" src="https://github.com/user-attachments/assets/8f2dfc86-bdba-4ae2-a8fd-9291ee208e79" />

<img width="866" height="476" alt="image" src="https://github.com/user-attachments/assets/623455f1-c017-403a-b6f3-eb96b0c3e4c2" />


### 11. Parse WHOIS Output with grep, awk, cut

```
whois google.com | grep -i "Creation Date" | head -1
```
<img width="469" height="65" alt="image" src="https://github.com/user-attachments/assets/dd86c659-10fb-44e2-90f5-5f401da0a85b" />

Extract only creation date.

- | grep -i "Creation Date": Pipes the output of whois to the grep command, which filters lines containing the phrase "Creation Date" (case-insensitive due to the -i flag).
- | head -1: Pipes the filtered output to head -1, which selects only the first line of the result.


```
whois google.com | grep -i "Registrar:" | awk -F: '{print $2}' | xargs
```
<img width="604" height="66" alt="image" src="https://github.com/user-attachments/assets/cf93b719-08c4-4b86-ba37-576561c9bc0d" />

Extract registrar.

- | grep -i "Registrar:" : Pipes the whois output to grep, filtering for lines containing "Registrar:" (case-insensitive due to -i).
- | awk -F: '{print $2}' : Pipes the filtered line to awk, which splits the line at the colon (:) using -F: and prints the second field ($2).
- | xargs : Pipes the output to xargs, which trims leading/trailing whitespace and passes it as an argument to a command (by default, echo if no command is specified).


- It use to search name server:
```
whois facebook.com | grep -i "Name Server" | awk -F: '{print $2}' | awk '{print $1}'
```
<img width="753" height="172" alt="image" src="https://github.com/user-attachments/assets/df69531b-c719-4197-a5ad-1fa06e89ade5" />

- awk -F: '{print $2}': 
Sets the field separator to : with -F:, so the line Name Server: NS1.FACEBOOK.COM splits into:
    - $1: Name Server
    - $2:  NS1.FACEBOOK.COM (with leading space)
- | awk '{print $1}': 
    - Removes the leading space by treating the output as a new line and printing only the first field (the name server name).


### 12. Using WHOIS in Python
```
python3 -m venv whois_env
source whois_env/bin/activate
```
<img width="297" height="153" alt="image" src="https://github.com/user-attachments/assets/be6bfc3d-241b-4a10-b51d-c70dcecd6811" />

```
pip3 install python-whois
```
<img width="656" height="227" alt="image" src="https://github.com/user-attachments/assets/e6fc3f32-68f7-4f74-9c12-8f95259a5d00" />

```
mousepad whois
```
<img width="284" height="86" alt="image" src="https://github.com/user-attachments/assets/6d2146a7-9086-4515-ba71-858e615c42f8" />

```
import whois

def lookup(domain):
    try:
        w = whois.whois(domain)
        print(f"Domain: {w.domain_name}")
        print(f"Registrar: {w.registrar}")
        print(f"Creation Date: {w.creation_date}")
        print(f"Expiration Date: {w.expiration_date}")
        print(f"Name Servers: {w.name_servers}")
        print(f"Country: {w.country}")
    except Exception as e:
        print(f"Error: {e}")

lookup("google.com")
```
<img width="637" height="408" alt="image" src="https://github.com/user-attachments/assets/489825a6-7e4b-4689-af6e-3369b7bf20e7" />

```
cat whois
```
<img width="470" height="288" alt="image" src="https://github.com/user-attachments/assets/4ba2a7a3-f363-46ab-8ede-6394a750d6f3" />

```
python3 whois
```
<img width="866" height="168" alt="image" src="https://github.com/user-attachments/assets/3fb05c8b-eb1e-4ecb-baeb-1bf3569eba25" />





## Use browser

1. whois lookup(Domain tools)

https://whois.domaintools.com/

<img width="1444" height="859" alt="image" src="https://github.com/user-attachments/assets/dd565df2-a7ac-4e3f-98c0-f57d6e6476c2" />

<img width="1205" height="921" alt="image" src="https://github.com/user-attachments/assets/947625b0-69fa-4761-a805-47b10db5b1fa" />


2. ICANN Lookup

https://lookup.icann.org/en/lookup

<img width="978" height="767" alt="image" src="https://github.com/user-attachments/assets/a180154b-72db-4531-bb77-12627348a668" />


3. iamroot.tech

https://iamroot.tech/whois/?gad_source=1&gad_campaignid=15753485188&gclid=CjwKCAjw7_DEBhAeEiwAWKiCC3tGlqRna1A5blqzjMaQfQS4dbq9SUTv_0lOw2qZJ4rpUFPgoyhvbxoCqgsQAvD_BwE

<img width="1918" height="929" alt="image" src="https://github.com/user-attachments/assets/ed62a747-d096-4268-ad6c-57fd6f58b5b2" />



## ===========>> End of WHOIS Lookup

### Refference
1. https://www.arin.net/resources/registry/whois/rws/cli/
2. https://www.baeldung.com/linux/whois-command
3. https://www.geeksforgeeks.org/linux-unix/how-to-use-the-whois-command-on-ubuntu-linux/
4. https://whois.domaintools.com/
5. https://lookup.icann.org/en/lookup
6. https://iamroot.tech/whois/?gad_source=1&gad_campaignid=15753485188&gclid=CjwKCAjw7_DEBhAeEiwAWKiCC3tGlqRna1A5blqzjMaQfQS4dbq9SUTv_0lOw2qZJ4rpUFPgoyhvbxoCqgsQAvD_BwE



## Practise in LAB by: Nin Kanong(k4n0ng)
