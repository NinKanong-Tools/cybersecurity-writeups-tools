# theHarvester

### What is TheHarvester?
TheHarvester is a powerful and widely used OSINT (Open Source Intelligence) tool that helps Ethical Hackers, Penetration Testers, and cybersecurity professionals collect information related to target domains and organizations from various search engines, databases, and other publicly available services. The primary function of theHarvester is to gather critical information about a target domain, such as:
- Subdomains: Alternative domain addresses linked to the target.
- Emails: Employee or organizational email addresses. One of the most valuable pieces of information you can collect during a reconnaissance phase is a list of email addresses. These emails can later be used for social engineering attacks or identifying potential weak points in security configurations.
- IP Addresses: TheHarvester can map domain names to associated IP addresses. These addresses can be used for further network scanning and vulnerability analysis.
- Hostnames: Additional domain names or services linked to the target.

### 1. Get help command
```
theHarvester -h
```
<img width="824" height="314" alt="image" src="https://github.com/user-attachments/assets/35ede482-556a-4dbe-bd83-f5583e8c665d" />

Common options:

Here’s a breakdown of the most commonly used options in TheHarvester:
   - -d <domain> : Specifies the domain to search.
   - -b <source> : Defines the data source (e.g., yahoo, bing, shodan). You can specify multiple sources separated by commas.
   - -c : Perform DNS brute force for subdomains
   - -l <limit> : Limit the number of results fetched from the data sources.
   - -s <start> : Start point for Google/Bing results (default: 0)
   - -f <filename> : Save the output into a file (in HTML format).
   - -n: Perform DNS enumeration using search results.
   - -t: Perform DNS TLD expansion.
   - -s <start> : Start with a specific result number (useful when you want to skip initial results).
   - -v: Enable verbose mode for more detailed output.
   - -R: Perform VHOST brute forcing
   - -p <ports> : Scan for specific open ports.
   - -s <shost> : Resume a previous search from a file.
   - -x : Enable DNS brute-forcing using subdomain wordlist.
   - -a : Use all sources.
   - -e <dns_server> : Use a custom DNS server.

### 2. Basic Email & Subdomain Search
```
theHarvester -d google.com -b google
```
<img width="554" height="541" alt="image" src="https://github.com/user-attachments/assets/1647c95f-a27d-4900-b0ff-e3eeb5792335" />

This command gathers subdomain data using Yahoo and displays the results.
For Comprehensive Search: To gather information from all sources, use:

```
theHarvester -d hackercoolmagazine.com -b all
```
<img width="557" height="424" alt="image" src="https://github.com/user-attachments/assets/1a03bd0b-5280-459a-a1d1-0c5a7523b68b" />

This command collects information about the specified domain (infosectrain.com) from all supported search engines and data sources.

```
theHarvester -d owasp.org -S 10
```
<img width="552" height="334" alt="image" src="https://github.com/user-attachments/assets/af05681e-961b-4493-830c-fcde413ae955" />


### 3. theHarvester with shodan
theHarvester also has a option called “–shodan” that queries the Shodan search engine for any open ports or banners from discovered hosts. However, this requires api keys.

```
theHarvester -d owasp.org --shodan
```
<img width="558" height="446" alt="image" src="https://github.com/user-attachments/assets/b36fe978-2c9c-407b-ad27-f48604eb4c8d" />


### 4. theHarvester with screenshot
This command allows theHarvester to take screenshots of subdomains that are found.
```
theHarvester --screenshot -h
```
<img width="835" height="341" alt="image" src="https://github.com/user-attachments/assets/424ac868-a518-4608-a894-dd0e0f2605e8" />

Get help.

```
theHarvester -d owasp.org --screenshot /home/k4n0ng/Desktop
```
<img width="728" height="547" alt="image" src="https://github.com/user-attachments/assets/76d34f05-bb59-40a3-9cd3-52af4413f050" />


 ### 5. theHarvester with -source
theHarvester uses many public sources to collect information. Some of them are anubis, baidu, bing, brave, censys, etc. We can even ask it to use a specific source using the “–source” command.
```
theHarvester -d owasp.org --source censys
```
<img width="552" height="348" alt="image" src="https://github.com/user-attachments/assets/f33d56af-c785-4ab6-991e-b6037001dd29" />


### 6.  Using Multiple Data Sources
```
theHarvester -d google.com -b bing,linkedin -f output.xml
```
<img width="487" height="521" alt="image" src="https://github.com/user-attachments/assets/23f7dcef-0b13-4b04-9781-8f2799d324f8" />

<img width="267" height="300" alt="image" src="https://github.com/user-attachments/assets/ed18a759-0aa3-44c9-ae6f-da2f539dd0ce" />

To use multiple data sources (e.g., Google, Bing, and LinkedIn).


### 7. Performing a DNS Brute-Force Search
```
theHarvester -d google.com -b all -s -f output.tx
```
<img width="486" height="333" alt="image" src="https://github.com/user-attachments/assets/bf8a5f46-7c30-4727-887b-50b56cd27988" />

<img width="473" height="259" alt="image" src="https://github.com/user-attachments/assets/7c1a4c62-55f3-423e-b07e-07ccbad012fc" />

To perform a DNS brute-force search for subdomains:
The -s flag enables the DNS brute-force feature, which attempts to discover subdomains by trying common prefixes (e.g., mail.example.com, ftp.example.com).



### 8. Limiting the Number of Results
```
theHarvester -d google.com -b yahoo -l 100 -f output.txt
```
<img width="550" height="472" alt="image" src="https://github.com/user-attachments/assets/ab4d725c-6d00-4033-be54-4b78129df615" />

<img width="214" height="463" alt="image" src="https://github.com/user-attachments/assets/47322fb3-3f3c-4f17-a6c8-89ca9f3b9079" />

To limit the number of results to 100:


### 9. VirtualHost Verification
```
theHarvester -d google.com -b all -v -f output.txt
```
<img width="551" height="355" alt="image" src="https://github.com/user-attachments/assets/f5a3b450-f059-4a0f-b596-7975eb706080" />

<img width="532" height="309" alt="image" src="https://github.com/user-attachments/assets/6448e686-919c-412b-8437-af3f5061e95c" />

To verify VirtualHosts for discovered IP addresses:
The -v flag enables VirtualHost verification, which checks if the discovered IP addresses host multiple domains.


### 10. Using AlienVault OTX
```
theHarvester -d google.com -b otx -f output.txt
```
<img width="483" height="520" alt="image" src="https://github.com/user-attachments/assets/1d4bf767-8228-428f-8bd3-6ec721691416" />

<img width="255" height="340" alt="image" src="https://github.com/user-attachments/assets/5052f140-5767-4b41-8e1d-f56722272b01" />

<img width="453" height="214" alt="image" src="https://github.com/user-attachments/assets/eca5d01a-d3b1-4eab-bd93-7b32ccc95ff5" />

To gather threat intelligence data from AlienVault OTX.


### 11. Exporting Results in Different Formats
```
theHarvester -d google.com -b all -f output.json
```
<img width="490" height="327" alt="image" src="https://github.com/user-attachments/assets/6f8a92f2-7fb6-4a86-a8ee-f081d803bc9a" />

TheHarvester supports multiple output formats, including XML, JSON, and HTML. For example, to export results in JSON.

#### ==>> Analyzing the Output
```
cat output.json
```
<img width="875" height="326" alt="image" src="https://github.com/user-attachments/assets/da36b8d2-7541-48e2-84df-d7b9301c82f9" />

==========>> End of theHarvester

Refference:
1. https://preciousvincentct.medium.com/the-harvester-d27112e435b6
2. https://www.infosectrain.com/blog/step-by-step-guide-for-theharvester-tool/
3. https://www.hackercoolmagazine.com/beginners-guide-to-theharvester-tool/


## Practise in LAB By: Nin Kanong(k4n0ng)
