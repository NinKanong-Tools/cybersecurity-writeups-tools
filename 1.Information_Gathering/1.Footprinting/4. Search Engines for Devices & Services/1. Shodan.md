# Shodan
<img width="740" height="380" alt="image" src="https://github.com/user-attachments/assets/c40b500b-70da-4d77-87f9-9c1c413b6e46" />


### What is Shodan?
Shodan is a search engine for Internet-connected devices and services. Unlike Google (which indexes websites), Shodan indexes IoT devices, servers, routers, webcams, ICS/SCADA systems, databases, and more.
- Google: “What is on the web?”
- Shodan: “What is on the Internet?”


## Ways to use shodan:
we can use shodan in three way:

### 1. Shodan Website Usage
We go to this website:
https://www.shodan.io/

==>> Common shodan filters 

<img width="596" height="41" alt="image" src="https://github.com/user-attachments/assets/be7d8020-5957-4445-b603-a5b4602d2e78" />

<img width="670" height="682" alt="image" src="https://github.com/user-attachments/assets/983f1f76-06ac-42bd-84f5-e40ac3c352e8" />

<img width="704" height="547" alt="image" src="https://github.com/user-attachments/assets/33ff18d3-00b5-482f-835a-21af1fb04f4b" />


#### 1. Search for domain:
- Searching by hostname & contry:
```
hostname:ababank.com country:KH
```
<img width="919" height="731" alt="image" src="https://github.com/user-attachments/assets/52fdee2f-3d40-4302-9838-e221b616aaf2" />


- Searching by organization name and country:
```
org:"ABA Bank Co., Ltd." country:KH
```
<img width="951" height="848" alt="image" src="https://github.com/user-attachments/assets/bd6bc626-6d68-4813-9874-41e74a8fdcae" />


- Searching by SSL certificate subject and country:
```
ssl.cert.subject.cn:ababank.com country:KH
```
<img width="963" height="906" alt="image" src="https://github.com/user-attachments/assets/fe5ace1b-4378-4e30-ad83-0b62c8be4429" />



#### 2. Webcams
- Basic Webcam Search
```
webcam
```
<img width="948" height="748" alt="image" src="https://github.com/user-attachments/assets/3575051c-88fe-4a47-8a0b-125082724938" />

```
title:webcam 2000
```
<img width="963" height="880" alt="image" src="https://github.com/user-attachments/assets/587afe13-dfc3-45f5-bbdb-eedc9aa60833" />

- Searching by Common Ports
Many webcams use specific ports to stream video. You can narrow your search by looking for open ports commonly used by webcam software.
```
webcam port:8080
```
<img width="941" height="512" alt="image" src="https://github.com/user-attachments/assets/8a7b2232-8aac-44f6-a76c-f1fbd0f351fb" />

```
webcam port:81
```
<img width="941" height="519" alt="image" src="https://github.com/user-attachments/assets/490ac5d7-57c8-4750-8cd0-99b011a97891" />


- Searching by Vulnerabilities or Brands
For a more targeted search, you can look for known vulnerabilities or specific brands. Security researchers often use this method to find vulnerable devices.

```
product:Vivotek Webcam
```
<img width="928" height="453" alt="image" src="https://github.com/user-attachments/assets/0a421ab9-8520-4b46-a0c6-e97e6a1636fa" />

```
product:"D-Link DCS"
```
<img width="924" height="510" alt="image" src="https://github.com/user-attachments/assets/a21236cb-2091-415a-bda9-ff49143f3cb7" />

<img width="839" height="362" alt="image" src="https://github.com/user-attachments/assets/4fa4cffb-57d6-4390-a3fe-c228a6427b82" />


- Searching for Specific Banners
A very effective method is to search for unique strings found in the HTTP headers or HTML of the webcam's login page. These banners often identify the device type or software.

```
html:"Webcam 7"
```
<img width="924" height="464" alt="image" src="https://github.com/user-attachments/assets/b2a02a22-9adf-4cc2-a93d-b29048acb9be" />

<img width="922" height="755" alt="image" src="https://github.com/user-attachments/assets/b6fbe347-e16a-4a6f-b9e6-e60762cade2d" />

```
http.title:"Netcam"
```
<img width="927" height="457" alt="image" src="https://github.com/user-attachments/assets/49443dd4-f21d-4bf4-9e8f-ba374532c844" />

- Combining Filters
You can combine multiple filters to refine your search. For example, to find webcams in a specific country, you would use the country filter.

```
webcam country:KH
```
<img width="938" height="494" alt="image" src="https://github.com/user-attachments/assets/a3d8c302-8c3b-41da-a4f3-c338637a41e2" />


#### 3. Apache

- This is the most direct filter. It will show you all devices that Shodan has identified as running the Apache web server.
```
product:apache
```
<img width="918" height="502" alt="image" src="https://github.com/user-attachments/assets/d75dbcb6-0df4-451a-a29c-e72b482eb5cf" />


- This allows you to search for a specific version of Apache. This is especially useful for finding servers with known vulnerabilities.
```
product:apache version:"2.4.52"
```
<img width="927" height="457" alt="image" src="https://github.com/user-attachments/assets/caf1bc93-1ad0-4a7e-a8a6-012ae9677597" />


- To find Apache servers in a specific country, like Cambodia, you would use the country filter.
```
product:apache country:KH
```
<img width="927" height="480" alt="image" src="https://github.com/user-attachments/assets/060a3d99-2a26-4396-9950-6794c2cb116d" />


- This is a more advanced search that looks for specific text in the title of the web page, which can help find default or misconfigured installations.
```
http.title:"Apache Test Page"
```
<img width="916" height="432" alt="image" src="https://github.com/user-attachments/assets/b5c2294b-8dad-4446-a915-f294ef526f18" />


#### 4. Find Exposed MongoDB Databases
Finding exposed MongoDB databases with Shodan is a common task for security researchers and a critical one for database administrators. By default, older versions of MongoDB were configured to be publicly accessible without authentication, which led to numerous data leaks. While newer versions are more secure by default, many exposed instances still exist.

##### 1. Basic Search Queries
- This is the most direct query to find any device that Shodan has identified as running MongoDB.
```
product:MongoDB
```
<img width="916" height="459" alt="image" src="https://github.com/user-attachments/assets/2721815f-85b8-475a-869e-77dea02d16dd" />


- This query targets the default port for MongoDB.
```
port:27017
```
<img width="916" height="511" alt="image" src="https://github.com/user-attachments/assets/1240c5ba-1da7-4c11-9394-2fbfc5ca4faa" />

- This phrase is often found in the banner of an exposed database. 
```
MongoDB Server Information
```
<img width="916" height="462" alt="image" src="https://github.com/user-attachments/assets/096247ce-1774-4a0b-a4e5-ad19c22dc5b1" />


##### 2. Finding Unauthenticated (Exposed) Databases
- This is the most effective and specific query.
```
product:MongoDB -authentication
```
<img width="916" height="457" alt="image" src="https://github.com/user-attachments/assets/86f69aff-8224-4a0b-815d-51e1f7d7b9da" />


- This query combines the most effective filters to find databases that are running on the default port, are revealing server information, and have no authentication.
```
"MongoDB Server Information" port:27017 -authentication
```
<img width="917" height="402" alt="image" src="https://github.com/user-attachments/assets/691a7cdb-3a8e-4947-8219-81aa1b4b7a16" />


- This query is used to find instances of Mongo Express, a web-based management interface for MongoDB.
```
"Set-Cookie: mongo-express=" "200 OK"
```
<img width="919" height="404" alt="image" src="https://github.com/user-attachments/assets/bade0a0d-0249-4460-affb-7e54e66f374e" />



#### 5. Find WordPress Sites
Finding WordPress sites with Shodan is a very common task for security researchers and web administrators. Shodan identifies WordPress installations by looking for unique strings in the HTML and HTTP headers that are characteristic of the platform.

##### 1. Basic Search Queries
- This is the most effective and direct way to find WordPress sites. 
```
http.component:wordpress
```
<img width="919" height="474" alt="image" src="https://github.com/user-attachments/assets/ab6b6266-4bdb-4a59-a03a-01ec80064fad" />


```
wordpress
```
<img width="919" height="470" alt="image" src="https://github.com/user-attachments/assets/1266f8aa-0af3-410a-9988-03b74d7e031d" />

##### 1. Finding Specific WordPress Assets and Vulnerabilities
- This is a powerful search for finding WordPress sites that have been installed but not yet configured. 
```
http.title:"WordPress › Installation"
```
<img width="919" height="470" alt="image" src="https://github.com/user-attachments/assets/cc0da43b-e354-49b2-84ea-bc4fe7b98f03" />


-  This query searches for the wp-content/plugins directory in the HTML content, which is a key indicator of a WordPress site.
```
html:"wp-content/plugins"
```
<img width="929" height="521" alt="image" src="https://github.com/user-attachments/assets/5942f54d-28b4-4e03-bcdf-ed1d6207ebfc" />


```
html:"wp-login.php"
```
<img width="929" height="471" alt="image" src="https://github.com/user-attachments/assets/6466f7b4-dc7d-4cb3-abbb-3dd0669b6dfd" />


##### 3. Combining Filters
- Finds WordPress sites located in the United States.
```
http.component:wordpress country:US
```
<img width="929" height="432" alt="image" src="https://github.com/user-attachments/assets/71c24adc-d6d0-4ba4-be24-a1c5aca17688" />



### 6. Find SSH Servers (Port 22) Running OpenSSH
To find SSH servers running OpenSSH on port 22 with Shodan, you can use a combination of search filters that specify the port, product, and protocol.

##### 1. Finding OpenSSH Servers:

- This is the most effective query. 
```
product:OpenSSH port:22
```
<img width="929" height="355" alt="image" src="https://github.com/user-attachments/assets/635814bd-f6f4-4dce-8ddc-05920f7c0c6b" />


##### 2. Refining Your Search:
- This query finds OpenSSH servers in Cambodia.

```
product:OpenSSH port:22 country:KH
```
<img width="912" height="514" alt="image" src="https://github.com/user-attachments/assets/352f79ec-3b8f-40c2-aa8a-f1cc93beecf9" />

- 
This search finds OpenSSH servers that are running on a Linux operating system.
```
product:OpenSSH port:22 os:Linux
```
<img width="912" height="614" alt="image" src="https://github.com/user-attachments/assets/55823a48-df6e-46de-b84f-ea71453c00b5" />


```
product:OpenSSH port:22 version:"8.2"
```
<img width="912" height="512" alt="image" src="https://github.com/user-attachments/assets/5fbb414d-172e-408c-97a4-a575ef1c98bd" />


- Note: Understanding the Shodan Banner
When Shodan finds an SSH server, it returns a banner with key information. A typical OpenSSH banner looks like this:
SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.2
From this banner, Shodan extracts the following:
    - Protocol: SSH-2.0
    - Product: OpenSSH
    - Version: 8.2p1
    - Operating System: Ubuntu


### 7. Find RDP (Windows Remote Desktop)

##### 1. Basic Search Queries

- This is the most common and direct way to find RDP servers.
```
port:3389
```
<img width="912" height="457" alt="image" src="https://github.com/user-attachments/assets/47d815a7-2217-4312-aba3-0fcaf664317c" />


- Shodan can often identify the product as "RDP" directly from the service banner.
```
product:rdp
```
<img width="912" height="425" alt="image" src="https://github.com/user-attachments/assets/78b52b58-dd2a-4a07-8840-9d34fc953dec" />


##### 2. Finding Vulnerable or Specific Servers

- This query finds RDP servers in a specific country, in this case, the Khmer. You can replace US with any country code.
```
port:3389 country:KH
```
<img width="932" height="733" alt="image" src="https://github.com/user-attachments/assets/41d74575-f26c-4e04-ba57-7150db102395" />


- his search finds RDP servers that are running a Windows operating system in Khmer.
```
port:3389 os:Windows country:KH
```
<img width="922" height="613" alt="image" src="https://github.com/user-attachments/assets/8f8dc75e-eeeb-4ab6-9dd3-28e80cff3879" />



### 8. Find Devices with "Login" in Page Title 
To find devices with the word "Login" in their page title on Shodan, you can use the http.title filter. This filter specifically searches for text within the HTML <title> tag of a website.

##### 1. Search Query
- This will find any device where the title of the web page includes the word "login".
```
http.title:login
```
<img width="922" height="477" alt="image" src="https://github.com/user-attachments/assets/a13c4fd4-71d1-4499-93e4-02cb12df60ce" />


##### 2. Refining the Search
- This query will find websites with "Login" in the title that are located in KHmer.
```
http.title:"Login" country:KH
```
<img width="922" height="477" alt="image" src="https://github.com/user-attachments/assets/369635da-892d-4383-8a4b-0992a1fe569b" />

- his will show you devices with "login" in the title that are using the HTTPS protocol on port 443.
```
http.title:login port:443 country:KH
```
<img width="922" height="707" alt="image" src="https://github.com/user-attachments/assets/1ff23e91-9e15-4e0b-8f02-053ef3f29944" />

-  If we want to be more specific, we can use quotes to search for a phrase.
```
http.title:"user login"
```
<img width="922" height="467" alt="image" src="https://github.com/user-attachments/assets/beeb42d2-e286-42d8-8226-275d990798b3" />


### 9. Find Devices with Screenshots (Great for Cameras) 
To find devices that have screenshots available on Shodan, you can use the has_screenshot filter. This is an excellent way to find cameras, webcams, and other devices with a graphical interface that Shodan was able to capture.

##### 1. Basic Search Queries
- This is the most direct way to find any device for which Shodan has a screenshot.
```
has_screenshot:true country:KH
```
<img width="958" height="590" alt="image" src="https://github.com/user-attachments/assets/1f6718f8-0020-4cd0-86f5-31b276450b9d" />

- To narrow your search to a specific country, such as Cambodia, you would add the country filter.
```
has_screenshot:true port:8080
```
<img width="958" height="703" alt="image" src="https://github.com/user-attachments/assets/6123fe61-7bb7-4a7b-bd23-902e589c2d8c" />


##### 2. Finding Cameras Specifically
- This query looks for devices with a screenshot and a page title that contains the word "webcam".
```
has_screenshot:true http.title:"webcam"
```
<img width="958" height="703" alt="image" src="https://github.com/user-attachments/assets/637edc1a-f806-477b-bc54-ca3535e13fe8" />

- This is an effective way to find screenshots of devices from a specific manufacturer, like D-Link, which produces many IP cameras and routers.
```
has_screenshot:true product:D-Link
```
<img width="926" height="736" alt="image" src="https://github.com/user-attachments/assets/4b7abfd8-8e07-4370-9ccc-3eac34f2e6c2" />



### 10. Search by IP or Network
To search by IP address or a network range on Shodan, you can use the net filter for a network or simply the IP address itself for a single device. This is a very targeted way to audit a specific asset or an entire block of IP addresses.

##### 1. Searching a Single IP Address
- To search for a single IP address, you simply enter the IP address in the search bar.
```
1.1.1.1
```
<img width="961" height="761" alt="image" src="https://github.com/user-attachments/assets/e499de61-988e-4111-8bd7-aa9df4a98f15" />

##### 2. Searching a Network Range (CIDR)
- This allows you to specify a block of IP addresses at once. You use the net filter for this.
```
net:192.168.1.0/24
```
<img width="961" height="761" alt="image" src="https://github.com/user-attachments/assets/312d36af-b253-4a84-bf52-0e3dc5151f0f" />


### 11. Find IOT Devices
```
hostname:"iot" country:US
```
<img width="961" height="761" alt="image" src="https://github.com/user-attachments/assets/4d8a892f-c290-4dd0-94ec-4656b778608b" />




## 2. Shodan Command Line (CLI)

#### 1. Install shodan CLI
```
python3 -m venv venv
socurce venv/bin/activate
```
<img width="246" height="196" alt="image" src="https://github.com/user-attachments/assets/109782bd-30b0-47d7-913f-db5a344a7bf6" />


```
pip install shodan
```
<img width="591" height="258" alt="image" src="https://github.com/user-attachments/assets/eab64ae2-42b4-4227-bc94-a1b79208441b" />

#### 2. Initialize the CLI
````
shodan init LHeObCFhNtzAvzn7KOAOfdbBhV9nruhC
````
<img width="405" height="117" alt="image" src="https://github.com/user-attachments/assets/7b68daf4-ea06-4641-9639-3916a2d6bb38" />

LHeObCFhNtzAvzn7KOAOfdbBhV9nruhC    is my API key


#### 3. Test setup 
````
shodan info
````
<img width="242" height="94" alt="image" src="https://github.com/user-attachments/assets/d773fb42-211d-476d-8c0f-ca852928aeed" />

You can search any commandline in linux or others OS, But in this my shodan has "0 query credits". So i can't show demo.

#### 4. Search Device
- find webcam in Khmer
````
shodan search webcam country:KH
````

Find webcams in Khmer.

- Find Apache servers on port 80
````
shodan search product:"Apache httpd" port:80
````

- Find exposed MongoDB databases
````
shodan search port:27017 product:"MongoDB"
````

It use to quotes for multi-word products.


#### 5. Get Details About an IP
- Get info about Google DNS
````
shodan host 8.8.8.8
````
Output includes: 
 Open ports
 Services
 Hostnames
 OS
 Vulns.
     
- Multiple IPs
````
shodan host 8.8.8.8 8.8.4.4 1.1.1.1
````


## 3. Using shodan with phython script API

#### 1. Search for Devices
````
nano shodan_search.py
````
<img width="219" height="53" alt="image" src="https://github.com/user-attachments/assets/5babebf9-6faa-46f9-8b01-15687fa2959b" />

````
import shodan
API_KEY = 'YOUR API'
api = shodan.Shodan(API_KEY)

try:
    results = api.search('http')
    print(f"Total results: {results['total']}")
    for result in results['matches']:
        ip = result['ip_str']
        port = result['port']
        hostnames = result.get('hostnames', [])
        print(f"IP: {ip}, Port: {port}, Hostnames: {hostnames}")
except shodan.APIError as e:
    print(f"Error: {e}")
````
<img width="547" height="322" alt="image" src="https://github.com/user-attachments/assets/f25da2f9-3f66-43c6-8f52-fceda6736326" />


````
python shodan_search.py
````
<img width="326" height="76" alt="image" src="https://github.com/user-attachments/assets/3e2d632d-1821-4fe6-b320-59af4203a829" />

- The script will search for http servers using your Shodan API.
- It will print total results and list IPs, ports, and hostnames.

##### ==>> But in this my shodan has 0 query credits, show i can't show demo.

#### 2. Get Host Details
````
nano shodan_hosts.py
````
- script
````
import shodan

API_KEY = 'YOUR API'
api = shodan.Shodan(API_KEY)

try:
    host = api.host('8.8.8.8')
    
    print(f"IP: {host['ip_str']}")
    print(f"Hostnames: {host.get('hostnames', [])}")
    print(f"Country: {host['country_name']}")
    print(f"Ports: {host['ports']}")

    for item in host['data']:
        print(f"Port: {item['port']}, Banner: {item['data'][:100]}...")
except shodan.APIError as e:
    print(f"Error: {e}")
````

````
python shodan_hosts.py
````
it will retrieves detailed information for a specific IP address.


#### 3. Save Results to CSV
````
nano shodan_CSV.py
````

````
import shodan
import csv

API_KEY = 'YOUR API'
api = shodan.Shodan(API_KEY)

try:
    results = api.search('webcam')

    with open('webcams.csv', 'w', newline='') as f:
        writer = csv.writer(f)
        writer.writerow(['IP', 'Port', 'Hostnames', 'Country'])
        for result in results['matches']:
            ip = result['ip_str']
            port = result['port']
            hostnames = ','.join(result.get('hostnames', []))
            country = result['location']['country_name']
            writer.writerow([ip, port, hostnames, country])
    print("Results saved to webcams.csv")
except shodan.APIError as e:
    print(f"Error: {e}")
````

````
python shodan_CSV.py
````

In This searches for devices and saves results to a CSV file for analysis.


#### 4. Vulnerability Check
````
nano shodan_vuln.py
````

````
import shodan

API_KEY = 'YOUR API'
api = shodan.Shodan(API_KEY)

try:
    results = api.search('vuln:CVE-2014-0160')
    
    print(f"Devices with CVE-2014-0160: {results['total']}")
    for result in results['matches']:
        ip = result['ip_str']
        port = result['port']
        print(f"Vulnerable Device - IP: {ip}, Port: {port}")
except shodan.APIError as e:
    print(f"Error: {e}")
````

````
python shodan_vuln.py
````
In This it will searches for devices with a specific CVE vulnerability.



### ===========>> End of SHODAN


## Practice in LAB by: Nin Kanong(k4n0ng)
### Date: 19/Aug/2025
