# Censys

<img width="1920" height="1080" alt="censys-og-image" src="https://github.com/user-attachments/assets/a98c804e-b9da-4a01-9fa3-bf0c90506e40" />

### What is Censys?
Censys is a powerful search engine for discovering internet-connected hosts, certificates, and networks, similar to Shodan but with a focus on comprehensive device and certificate data. It’s widely used for cybersecurity tasks like asset discovery, vulnerability assessment, and network monitoring. Below, I’ll provide a detailed set of demos showcasing how to use Censys via its web interface, command-line interface (CLI), and Python API, covering key functionalities like searching for hosts, certificates, and networks. These demos are designed to give you a complete picture of Censys’s capabilities, based on your request and the context of how similar tools like Shodan operate.

### What Censys scans?
Censys continually scans the entire public IPv4 address space across all possible IP and port combinations using automatic protocol detection. The results are the most accurate representation of the Internet’s current state.

Censys also leverages redirects and the Domain Name System to discover and scan hundreds of millions of in-use IPv6 addresses.

### Censys scan details and frequency
"Discovery" in Censys datasets means that a service was identified on an IP and/or port that was not there last time our scans looked.

After a service is discovered, Censys prioritizes refreshing the information about that service to ensure it is accurate and up to date.

Every day, the age of each of the billions of services in our datasets is checked. Any unnamed service with an observation timestamp older than 24 hours is scanned again. With this process, the average age of high-value service data is approximately 16 hours.

Censys continuously conducts the scans and analyses described below.


### Global scan of popular ports
Censys continually and rapidly scans the whole IPv4 space on over 100 ports with IANA-assigned services.

### Cloud provider scans
Our accelerated cloud docket contains a list of IPs and common ports for AWS, Azure, and GCP cloud hosting providers. The number of ports in this docket is approximately one thousand. It is optimized to hit each docket item at least one time per day, and sometimes more often.

Using both the current and historical data from the services found on these dockets, and other data in our dataset, we generate dynamic scanning targets on a continual basis using our predictive scanning engine.

### Predictive scanning engine
Using both the current and historical data from the services found via global and cloud provider scans, we generate dynamic scanning targets on a continual basis using our predictive scanning engine. The methods described above essentially act as seeds of the input to this engine, which can be used to more accurately find and predict the best possible IPs and ports to scan. Predictive scanning accounts for over 40% of all services we find on the Internet today.

### IPv4 internet scan
Censys continuously scans all 65,535 ports on the IPv4 internet to gather as much background information as possible across all possible IP and port combinations.

Censys data schemas

Objects identified by Censys scans are structured and presented using Censys data schemas for hosts, web properties, and certificates. Each of those top-level data records can contain multiple subsidiary objects like location and service information, and many subsidiary objects contain additional subsidiary objects. This hierarchical relationship between top-level data records, their objects, and the fields contained within each is shown in the data definitions page in the web interface(opens in a new tab).

<img width="1680" height="317" alt="image" src="https://github.com/user-attachments/assets/0f156cb2-fa66-4c6c-a208-78805f81a495" />


Relationships between different hosts, web properties, and certificates can be examined using Censys data. For example, a host service may present a certificate during a TLS handshake observed by Censys scans. You could use the fingerprint of this certificate from the host service records to examine the specific certificate record in Censys or use it to pivot to other host services that are using it.

It might be helpful to think of the internet map produced by all Censys scans as similar to Google Maps. Consider hosts, web properties, and certificates as the discrete objects present on that map. You can explore the connections between them by examining data field-value pairs to understand the relationships between disparate assets.

You can explore the vast amount of data available in the Censys Platform by running queries in the Platform web interface(opens in a new tab). The easiest way to get started is by trying some example queries(opens in a new tab).

<img width="1009" height="677" alt="image" src="https://github.com/user-attachments/assets/a75fa635-a03a-484e-ba1d-2558d45ffa84" />

<img width="966" height="618" alt="image" src="https://github.com/user-attachments/assets/955ae011-4351-4289-a189-2cb3b17f2d7c" />

<img width="1002" height="637" alt="image" src="https://github.com/user-attachments/assets/072875ba-c452-431b-a030-dea31ca79459" />


We will explore the three main types of data record (hosts, web properties, and certificates) in greater detail in the next lesson.

Host and web property records contain context objects like software, hardware, operating system, and more to describe the various services and content present on them. These objects make it easy to identify products, services, and other items of interest.

Data field types

Many different field types are available in the Censys datasets. A field type defines the type of content provided for its values. Every field's type is provided in the data definitions page in the web app(opens in a new tab). They correspond to Elasticsearch field formats(opens in a new tab). A sample of common field types is provided below.

<img width="582" height="421" alt="image" src="https://github.com/user-attachments/assets/c9cf6bea-114e-4bf9-8657-77b7036afc99" />



### Host
The Censys Platform host dataset provides accurate, up-to-date records that reflect the reality of public IPv4 and IPv6 hosts. These records contain a wide variety of fields that you can query using Censys Query Language (CenQL) and full-text searches.

In the Platform dataset, hosts are identified by an IP address.

In addition to service data obtained from scanning, Censys also enriches host records with high-quality data from third parties to provide information such as geographical location, network routing information, DNS names, and more.

In this lesson, you will learn some of the data objects and fields present on host records in the Platform datasets to help get you searching. Remember that all Censys dataset fields start with the type of data record they are present on (host, web, or cert).

In addition to this information, the example queries provided in the web app(opens in a new tab) are a useful place to start.

<img width="1012" height="550" alt="image" src="https://github.com/user-attachments/assets/2081ab8d-b43c-4fed-a3f3-90f3801dde47" />


- Host information
All of the fields available for host records are listed in the data definitions section of the Platform web app.(opens in a new tab) That page is always kept up-to-date and reflects the current structure of the Censys Platform host dataset.

##### Host services

Host service objects (host.services(opens in a new tab)) contain detailed information about the protocols running on an IP. Each service contains some common information, such as identified software(opens in a new tab) and hardware(opens in a new tab), TLS(opens in a new tab) and certificate information(opens in a new tab), labels, and other metadata.

In addition to plain text names, Common Platform Enumeration (CPE) values are also provided for software and hardware and their components.

Many services contain highly detailed protocol-specific information. This protocol-specific information is found in a nested object with the same name as the protocol. For example, SSH-specific information can be found within host.services.ssh(opens in a new tab).

Unidentified protocols are reported with UNKNOWN values. This can be because the service is not adhering to a protocol or because the protocol is very uncommon and Censys does not yet have a protocol-specific scanner written for it.

HTTP services use a different representation of protocol-specific data. HTTP service data can be found at host.services.endpoints(opens in a new tab). Each endpoint offers information about a web application or HTTP GET response for a specific URI. To access web application information, use host.services.endpoints.[application_type], such as host.services.endpoints.prometheus. To access HTTP GET information, use host.services.endpoints.http(opens in a new tab).

<img width="476" height="466" alt="image" src="https://github.com/user-attachments/assets/6b218119-461a-4a90-ace6-c5de6346e11c" />


##### Host service labels
Labels on services (host.services.labels) are used to categorically describe the services present on hosts. Label values are always in screaming snake case(opens in a new tab). Examples include:

  - LOGIN_PAGE(opens in a new tab)
  - OPEN_DIRECTORY(opens in a new tab)
  - WAF(opens in a new tab)
  - DEFAULT_LANDING_PAGE(opens in a new tab)

##### Nested fields
Some data fields are nested. You can use nested fields to require that multiple search criteria are true of a single object on a data record (like a service), instead of the host, web property, or certificate as a whole. For example, you can use nested fields in a query to only return results that are presenting a specific service on specific port.


### Web properies
Censys Platform, internet assets that respond to hostname-based scans are classified as web properties.

Web properties are identified by a hostname and a port. Hostnames can be name-based records (such as app.censys.io) or IP-based records (such as 104.18.10.85). Example names of web property records include the following:
    - app.censys.io: 443
    - 104.18.10.85: 8880

Web properties provide an accurate, up-to-date, and comprehensive view of name-based assets on the worldwide web. You can use web properties to explore:

   - Websites
   - APIs
   - Web-based applications

<img width="991" height="545" alt="image" src="https://github.com/user-attachments/assets/7ff1f711-2ffb-462c-abc8-3ca67270fa42" />


Web property information

All of the fields available for web property records are listed in the data definitions section of the Platform web app(opens in a new tab). That page is always kept up-to-date and reflects the current structure of the Censys Platform web property dataset.

Web properties offer insight into HTTP services beyond layer 7 while abstracting away HTTP protocol semantics.

   - Web properties contain all records that correlate to HTTP-based scans.

   - web property can have one or more endpoints, which serve as distinct entry points to different resources or functionalities within the web property.
   - Each endpoint may be associated with specific applications, services, or APIs and can be individually monitored and analyzed.

   - Web properties support deep scan information for HTTP-based scanners.

As with hosts, CPE values are provided for software on web properties.

#### Web property HTTP fields
Web property records surface deep information about individual HTTP endpoints(opens in a new tab). This includes:
  - HTTP body information (web.endpoints.http.body, as well as hash fields).
  - Software that runs on top of HTTP, like pprof (web.endpoints.pprof), Kubernetes(opens in a new tab) (web.endpoints.kubernetes), and Elasticsearch(opens in a new tab) (web.endpoints.elasticsearch).

Web properties also contain contextual information about the asset's associated software, hardware, certificates, and more.

#### Web properties and host services

Web properties offer better visibility into internet assets than services on hosts in certain circumstances. In the Censys Platform, consider searching web properties when:
  - You want results that include hostnames.
  - You are targeting software that runs on top of HTTP.
  - You are targeting software that services HTTP, like Apache or nginx.
  - You need HTTP body information.
  - You need data from endpoints other than /.

Do not use web properties when:

   - You want results that include IP addresses.
   - You are searching for DNS data, WHOIS data, location data, or routing data.
   - You are searching for hosts serving HTTP as well as non-HTTP protocols.

<img width="547" height="446" alt="image" src="https://github.com/user-attachments/assets/2e375c7f-c51a-4a4a-9d7a-da1717b70da9" />

#### Web property labels

Labels on web properties (web.labels) are used to categorically describe the content and services present on them, just like they are for host services. Web property label values are always in screaming snake case(opens in a new tab). Many web property labels are the same as those used for host services and include:
   - LOGIN_PAGE
   - WAF
   - DEFAULT_LANDING_PAGE
   - CAMERA


### Certificate
Certificates are an important part of internet traffic encryption. They can verify the identities of the services that are communicating to each other. Censys collects certificates in a repository for searching and viewing.

The Censys certificate dataset is the most exhaustive collection of X.509 documents in existence. It consists of over 10 billion records and records are added on a daily basis.

In the Censys Platform, certificates are indexed and identified by their "fingerprint," which is the SHA-256 digest of the entire raw certificate. You can use this information to directly navigate to a certificate record in the Platform web interface. It is also recorded in the cert.fingerprint_sha256 field on certificate records.

Each Censys certificate record contains:

   - Data parsed from the certificate using ZCrypto, an open-source, Go-based, cryptographic library.

   - Trust information from major root stores such as Apple, Google Chrome, Microsoft, and Mozilla NSS.

   - Submission information from Certificate Transparency (CT) logs.

        Learn more about certificate transparency(opens in a new tab) and its effect on the Censys certificates repository.

   - Lint results describing non-conformance to the X.509 standard using the ZLint library.

   - Data about Censys collection and observation during scan.


#### Certificate collection

Certificates are collected using two methods:

  - Syncing with a number of CT logs.
  - Observing a certificate presented as part of a TLS handshake during a Censys scan of the public internet over any protocol.

Certificate objects and fields

The contents of a certificate are immutable and cannot be changed after the certificate is generated.

Censys parses the contents of each certificate and provides them as searchable fields in an object called cert.parsed. These fields include, but are not limited to the following. A full list of certificate fields is available here(opens in a new tab).

  - Issuer(opens in a new tab): Information about the certificate authority that issued the certificate.
  - Subject(opens in a new tab): Information about the entity that was issued the certificate.
  - Validity period(opens in a new tab): The dates from which and to which the certificate can be used.
  - Subject alternate names: The additional names that may be used by a certificate.
  - Signature algorithm(opens in a new tab): The algorithm used to sign the certificate.
  - Signature value: Bit string containing the digital signature.


Other data about the certificate and the collection process also appear in a Censys certificate record, such as:
  - Trust and validation: Information about the status of the certificate’s trust by modern web browsers.
  - Certificate transparency(opens in a new tab): Information about submissions to CT logs.
  - ZLint(opens in a new tab): Whether the certificate’s attributes triggered any lints for non-conformance to the X.509 standard
  - Seen in scan (cert.ever_seen_in_scan): Whether the certificate has ever been seen during a Censys scan of the internet.
       - This is a one-way boolean--if true, it remains that way.



Certificate trust and validation

Trust chains are an important part of certificate usage. For a certificate to be trusted, the certificate must chain up, through a series of signing certificates, to a root certificate that is present in a major root trust store.

Censys indexes certificate trust information for each root store in a record called validation. The following fields are prepended by the applicable browser, for example the full path for the ever valid field described below for Chrome is cert.validation.chrome.ever_valid. The following information is contained within certificate validation fields:

  - Valid (*.is_valid): A boolean value for whether the certificate is trusted by the browser using the root store.
  - Ever valid (*.ever_valid): A boolean value for whether an expired certificate was trusted by the browser before it expired.
  - Parents (*.parents): A list of the fingerprints of the intermediary and root certificates in the chain.
  - Chain (*.chains): A representation of the chain or chains of signing certificates up to the root.
  - Had trusted path (*.had_trusted_path): A boolean value for whether the chain was trusted by the browser.
  - In revocation set (*.in_revocation_set): Whether the certificate is included in the browser’s list of certificates whose trust has been revoked before their expiration.

Censys regularly validates unexpired certificates. Values of validation fields and related labels are accurate as of the cert.validated_at timestamp in the certificate record.




### ============>> Finished censys

#### Refference
1. censys.io


### Practice in Lab by: NIn Kanongk4n0ng)

##### Date: 19/Aug/2025
