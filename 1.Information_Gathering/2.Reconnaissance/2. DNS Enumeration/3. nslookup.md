# nslookup

### What is nslookup?
nslookup(Name Server Lookup) : It’s a command-line tool used to query DNS (Domain Name System) to:
        - Find the IP address of a domain
        - Find DNS records (like MX, NS, CNAME)
        - Troubleshoot DNS issues

#### LAB Tool:
Kali Linux


### 1. Basic Query (default A record lookup)
````
nslookup tesla.com
````
<img width="280" height="433" alt="image" src="https://github.com/user-attachments/assets/8ef3df06-d881-4c9b-9e20-c79eca83712c" />


### 2. Query a Specific DNS Record Type
#### 1. A record (IPv4 address)
````
nslookup -type=A facebook.com
````
<img width="325" height="164" alt="image" src="https://github.com/user-attachments/assets/e7e4ea8a-3118-4dc4-b761-393c70f5900c" />

- -type=A :  specifies which DNS record type to query

#### 2. AAAA record (IPv6 address)
````
nslookup -type=AAAA google.com
````
<img width="439" height="257" alt="image" src="https://github.com/user-attachments/assets/76ad597a-73a9-45a0-b7e8-bc546623790a" />

- -type=AAAA : What kind of DNS record you want

#### 3. MX record (Mail server)
````
nslookup -type=MX google.com
````
<img width="434" height="249" alt="image" src="https://github.com/user-attachments/assets/382f33dc-0508-4606-aa29-b0ef0d2214be" />

- -type=MX : Query for Mail Exchange records

#### 3. NS record (Nameservers)
````
nslookup -type=NS yahoo.com
````
<img width="422" height="339" alt="image" src="https://github.com/user-attachments/assets/928000d0-10c9-4453-9233-201434ea8b9c" />

- -type=NS : Query for Name Server records

#### 4. TXT record
````
nslookup -type=TXT google.com
````
<img width="972" height="370" alt="image" src="https://github.com/user-attachments/assets/f307a658-a3e3-4cd8-9f61-380be19f3f30" />

- -type=TXT : Query for TXT (Text) records

#### 5. SOA record (Start of Authority)
````
nslookup -type=SOA cloudflare.com
````
<img width="456" height="307" alt="image" src="https://github.com/user-attachments/assets/9eae5b39-a761-41eb-872e-7fe57a773fad" />

- -type=SOA : Query for Start of Authority record

#### 6. CNAME record (Aliases)
````
nslookup -type=CNAME mail.google.com
````
<img width="402" height="306" alt="image" src="https://github.com/user-attachments/assets/927de9c6-4390-4fd4-8eb2-d704da68d79b" />

- -type=CNAME : Query for Canonical Name (alias) record.

#### 7. PTR record (Reverse DNS lookup)
````
nslookup 8.8.8.8
````
<img width="366" height="126" alt="image" src="https://github.com/user-attachments/assets/1a955cca-a98f-43fa-ab3f-a827967f7cf4" />



### 3. Use a Specific DNS Server
````
nslookup facebook.com 1.1.1.1
````
<img width="395" height="199" alt="image" src="https://github.com/user-attachments/assets/5cfc26dc-583c-4e39-946d-6d394018b91b" />

- This command use to queries Facebook using Cloudflare DNS.


### 4. Interactive Mode
````
nslookup
````
````
> google.com
````
<img width="339" height="488" alt="image" src="https://github.com/user-attachments/assets/fc8373f8-66b9-4c8e-9a2b-97f8cfd0599e" />

````
> set type=mx
> google.com
````
<img width="487" height="268" alt="image" src="https://github.com/user-attachments/assets/0bf7cb80-a55b-4b68-9e82-7c5be9d2795f" />

````
> server 8.8.8.8
````
<img width="224" height="139" alt="image" src="https://github.com/user-attachments/assets/02ddb59c-67d7-4f04-a91a-bdb3513efcf3" />


````
> facebook.com
````
<img width="405" height="222" alt="image" src="https://github.com/user-attachments/assets/b8ea7b71-362b-4e39-bb2c-38bf8bf2498d" />

If we want to left this :
````
exit
````

We can use with others:
set type=A :	Query IPv4 addresses (default)
set type=AAAA	: Query IPv6 addresses
set type=CNAME :	Show aliases
set type=NS :	Find name servers
set type=MX :	Find mail servers
set type=TXT :	View SPF, DKIM, verification
set timeout=5 :	Wait 5 seconds before giving up
set debug :	Show detailed query process
set nodata :	Hide empty responses
set port=53	: Use a specific port (rarely changed)



### 5. Find All Available Records (ANY query)
````
nslookup -type=ANY tesla.com
````
<img width="350" height="158" alt="image" src="https://github.com/user-attachments/assets/c49679b6-e819-4423-ab54-c3f8971f2588" />

We can use difference ANY

````
nslookup -type=A google.com

nslookup -type=AAAA facebook.com

nslookup -type=CNAME tesla.com

nslookup -type=MX google.com

nslookup -type=TXT facebook.com

nslookup -type=NS yahoo.com
````


### 6. Change Query Class
````
nslookup -class=IN tesla.com
````
<img width="297" height="421" alt="image" src="https://github.com/user-attachments/assets/f9032e8d-bbd6-4a36-90ab-58d8fd2b25e2" />

- -class=IN : Specifies the DNS class : Internet


### 7. Query a Subdomain
````
nslookup mail.google.com
````
<img width="351" height="388" alt="image" src="https://github.com/user-attachments/assets/ba7732f9-1de9-47e9-8c6d-9b1a25758719" />


### 8. Debug Mode
````
nslookup -debug google.com
````
<img width="412" height="688" alt="image" src="https://github.com/user-attachments/assets/8b7e7694-d036-4fc2-9529-013fe171f515" />

<img width="418" height="439" alt="image" src="https://github.com/user-attachments/assets/1bdbf561-8a0c-47a6-bfd4-bf37f204e884" />


### 9. Timeout and Retry Options
#### 1. Set timeout (seconds):
````
nslookup -timeout=10 tesla.com
````
<img width="326" height="429" alt="image" src="https://github.com/user-attachments/assets/76bccc4a-ef99-4655-84a9-de5399a39a24" />

#### 2. Set retry count:
````
nslookup -retry=3 google.com
````
<img width="402" height="455" alt="image" src="https://github.com/user-attachments/assets/5949fb50-5b44-47bd-8c2e-62c9c3485523" />


## Script of nslookup
This script is write in python i used AI to support with that because we don't want only use tool we combine it with script like:
````
#!/usr/bin/env python3

import argparse
import socket
import dns.resolver
import dns.reversename
from typing import List

def resolve_a(domain: str) -> List[str]:
    """Resolve A records (IPv4)"""
    try:
        answers = dns.resolver.resolve(domain, 'A')
        return [str(rdata) for rdata in answers]
    except Exception:
        return []

def resolve_aaaa(domain: str) -> List[str]:
    """Resolve AAAA records (IPv6)"""
    try:
        answers = dns.resolver.resolve(domain, 'AAAA')
        return [str(rdata) for rdata in answers]
    except Exception:
        return []

def resolve_mx(domain: str) -> List[str]:
    """Resolve MX records (mail servers)"""
    try:
        answers = dns.resolver.resolve(domain, 'MX')
        return [f"{rdata.preference} {rdata.exchange}" for rdata in answers]
    except Exception:
        return []

def resolve_cname(domain: str) -> List[str]:
    """Resolve CNAME records (aliases)"""
    try:
        answers = dns.resolver.resolve(domain, 'CNAME')
        return [str(rdata.target) for rdata in answers]
    except Exception:
        return []

def resolve_txt(domain: str) -> List[str]:
    """Resolve TXT records (SPF, DKIM, etc.)"""
    try:
        answers = dns.resolver.resolve(domain, 'TXT')
        return [''.join(rdata.strings.decode() for rdata in answers) for rdata in answers]
    except Exception:
        return []

def resolve_ns(domain: str) -> List[str]:
    """Resolve NS records (name servers)"""
    try:
        answers = dns.resolver.resolve(domain, 'NS')
        return [str(rdata.target) for rdata in answers]
    except Exception:
        return []

def reverse_lookup(ip: str) -> str:
    """Reverse DNS lookup (PTR)"""
    try:
        rev_name = dns.reversename.from_address(ip)
        answers = dns.resolver.resolve(rev_name, 'PTR')
        return str(answers[0])
    except Exception:
        return "No PTR record"

def main():
    parser = argparse.ArgumentParser(description="Python nslookup tool")
    parser.add_argument("domain", nargs="?", help="Domain to query (e.g., example.com)")
    parser.add_argument("-ip", "--ip", help="Perform reverse lookup on IP address")
    parser.add_argument("--no-ipv6", action="store_true", help="Skip AAAA records")
    parser.add_argument("--types", help="Comma-separated record types: A,AAAA,MX,TXT,CNAME,NS")

    args = parser.parse_args()

    if args.ip:
        print(f"Reverse lookup for {args.ip}:")
        print(f"  PTR → {reverse_lookup(args.ip)}")
        return

    if not args.domain:
        print("Error: You must provide a domain or use --ip for reverse lookup.")
        print("Usage: pynslookup.py example.com")
        print("       pynslookup.py --ip 8.8.8.8")
        return

    domain = args.domain

    print(f"\nNon-authoritative answer for: {domain}")
    print("-" * 50)

    types = args.types.split(",") if args.types else ["A", "AAAA", "MX", "CNAME", "TXT", "NS"]
    types = [t.upper().strip() for t in types]

    if "A" in types:
        a_records = resolve_a(domain)
        if a_records:
            print("A Records (IPv4):")
            for ip in a_records:
                print(f"  {ip}")

    if "AAAA" in types and not args.no_ipv6:
        aaaa_records = resolve_aaaa(domain)
        if aaaa_records:
            print("AAAA Records (IPv6):")
            for ip in aaaa_records:
                print(f"  {ip}")

    if "MX" in types:
        mx_records = resolve_mx(domain)
        if mx_records:
            print("MX Records (Mail Servers):")
            for mx in mx_records:
                print(f"  {mx}")

    if "CNAME" in types:
        cname_records = resolve_cname(domain)
        if cname_records:
            print("CNAME Records (Aliases):")
            for cname in cname_records:
                print(f"  {cname}")

    if "TXT" in types:
        txt_records = resolve_txt(domain)
        if txt_records:
            print("TXT Records:")
            for txt in txt_records:
                print(f"  \"{txt}\"")

    if "NS" in types:
        ns_records = resolve_ns(domain)
        if ns_records:
            print("NS Records (Name Servers):")
            for ns in ns_records:
                print(f"  {ns}")

    print("")

if __name__ == "__main__":
    main()
````
<img width="753" height="466" alt="image" src="https://github.com/user-attachments/assets/8e7a316a-b2df-4c3f-989c-14e884d19c04" />

This script i was run it in VSCode in kali to make it easy because in kali already have some module,but if we run it in windows we need to install some module.

#### We can run it more command:
````
/bin/python /home/k4n0ng/Documents/scanning/Scanning_Tools.py/nslookup.py --ip 8.8.8.8

/bin/python /home/k4n0ng/Documents/scanning/Scanning_Tools.py/nslookup.py --no-ipv6
````


#### ==============>> End of nslookup

### In real world hacking attacker use nslookup to collect public DNS info before using other tools like nmap, metasploit, or social engineering.


### Practice in LAB BY: Nin Kanong(k4n0ng)

##### Date: 25/AUG/2025
