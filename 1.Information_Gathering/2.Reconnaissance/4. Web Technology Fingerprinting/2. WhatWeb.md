# Whatweb

![hq720](https://github.com/user-attachments/assets/46dc535d-9600-4a01-ae28-faa172f29a05)

What is WhatWeb?
WhatWeb is an open-source tool designed to identify various technologies used by a website. By running WhatWeb against a target URL, it will enumerate and provide details about:
   - Web server software (e.g., Apache, Nginx, IIS)
   - CMS (Content Management System) such as WordPress, Joomla, or Drupal
   - Programming languages in use (e.g., PHP, Ruby, Python)
   - Web frameworks (e.g., React, Django, Laravel)
   - Libraries and APIs (e.g., jQuery, Bootstrap, Google Maps)
   - Security features (e.g., SSL/TLS, security headers)
   - Plugins and server-side components

### LAB Tool
- Kali Linux
- Juice shop
- DVWA 
I run JUICE AND DVWA on my docker.

### 1. Installation
````
sudo apt install whatweb -y
````
<img width="763" height="219" alt="image" src="https://github.com/user-attachments/assets/d57ee14e-58a9-466e-8f4e-3b751ab672bf" />

Somehow in kali this tool already have authomatic.

- to check verify
````
whatweb --version
````
<img width="641" height="88" alt="image" src="https://github.com/user-attachments/assets/13326429-e458-4b56-8e9d-e73acb57add9" />


### 2. Scan a Single Website
````
whatweb http://192.168.100.97:8080/index.php
whatweb http://192.168.100.97:3000/#/
````
<img width="897" height="124" alt="image" src="https://github.com/user-attachments/assets/4701dc72-c1fa-4ac6-a734-6cb161033b38" />

<img width="896" height="91" alt="image" src="https://github.com/user-attachments/assets/d9487a2b-ee3d-4eff-9ea2-ec334ba2c066" />


### 3. Scan with Verbose Output
````
whatweb -v https://example.com
````
<img width="906" height="644" alt="image" src="https://github.com/user-attachments/assets/44fa97e8-1f99-4dcd-b9a1-28bb3cbb4ac0" />

<img width="593" height="302" alt="image" src="https://github.com/user-attachments/assets/1ab4a152-dbba-4bd1-a2e0-d9300bf2d9a1" />

- Shows more details like headers, cookies, plugins, and frameworks.
- -v: Enables verbose mode, showing detailed information about the scanning process, including plugins used, HTTP requests, and matches found.


### 4.Scan Multiple URLs from a File
````
nano targets.txt
````
<img width="177" height="50" alt="image" src="https://github.com/user-attachments/assets/6a2dabd5-9cb1-4bd5-9441-0d42374a31c9" />

````
http://192.168.100.97:3000/#/
http://192.168.100.97:8080/index.php
````
<img width="590" height="154" alt="image" src="https://github.com/user-attachments/assets/9c4e8397-96a7-4930-8914-8b0413755258" />

<img width="903" height="170" alt="image" src="https://github.com/user-attachments/assets/dba7de45-dd45-4c6e-a584-2a6dc219b587" />

- -i : input file.
- Output will list all detected technologies for each URL


### 5. Save Output to File
````
whatweb -i targets.txt -a 3 -v > results.txt
````
<img width="928" height="547" alt="image" src="https://github.com/user-attachments/assets/7f02d49a-52a6-450e-9937-eaf7d599d326" />

<img width="904" height="594" alt="image" src="https://github.com/user-attachments/assets/fbe2685f-4c03-4a68-afdb-aac3ca628222" />

- -a 3 : Aggression level 3 (more thorough detection)
- -v : verbose


  #### Aggression Levels
  
| Option | Description                                             |
| ------ | ------------------------------------------------------- |
| `-a 0` | Default, minimal                                        |
| `-a 1` | Some detection                                          |
| `-a 2` | Moderate detection                                      |
| `-a 3` | Full aggressive detection, slow                         |
| `-a 4` | Maximum, includes plugin detection and detailed headers |


### 6. Detect Only Certain Plugins or Technologies
````
whatweb -a 3 --plugins Wordpress,PHP http://192.168.100.97:8080/index.php
````
<img width="639" height="155" alt="image" src="https://github.com/user-attachments/assets/f954de10-425d-42c4-9a05-f45595834d69" />

- this command focus on specific technologies.
- --plugins Wordpress,PHP: Specifies the plugins to use during the scan. WhatWeb has a variety of built-in plugins to detect specific technologies.


### 7. Scan with Custom Headers / User-Agent
````
whatweb -a 3 -H "User-Agent: Mozilla/5.0" http://192.168.100.97:8080/index.php
````
<img width="899" height="145" alt="image" src="https://github.com/user-attachments/assets/e69ca7eb-4fb6-4d20-bb1c-b8480e8a7764" />

- -H "User-Agent: Mozilla/5.0": Adds a custom HTTP header to the requests sent by WhatWeb. The User-Agent: Mozilla/5.0 mimics a generic web browser (e.g., Firefox or Chrome), which can help avoid detection as a scanner or bypass basic user-agent-based filtering by the target server.

````
whatweb -H "Cookie: session=abcd1234" http://192.168.100.97:8080/index.php
````
<img width="888" height="140" alt="image" src="https://github.com/user-attachments/assets/64cc1a91-c85a-402a-9b0e-9707f6131759" />

- Send a cookie with request.


### 8. Scan Multiple Targets in Parallel
````
cat targets.txt | xargs -n 1 -P 4 whatweb -a 3 -v
````
<img width="899" height="532" alt="image" src="https://github.com/user-attachments/assets/5576f9d9-556f-49be-82d1-4e0df279a964" />

<img width="913" height="486" alt="image" src="https://github.com/user-attachments/assets/853eb57a-b363-436b-a06f-b0a444577c8c" />

- This command is a pipeline used to scan multiple targets listed in a file with WhatWeb, a website fingerprinting tool.
- xargs: Takes the input from the pipe and passes it as arguments to the following command (whatweb).
- -n 1: Ensures each line from targets.txt is treated as a single argument, so whatweb processes one target at a time.
- -P 4: Runs up to 4 parallel processes of whatweb simultaneously, speeding up the scan by distributing the workload across multiple targets.


### 9. JSON Output
````
whatweb -i targets.txt -a 3 -v --log-json results.json
````
<img width="908" height="651" alt="image" src="https://github.com/user-attachments/assets/f464b565-a203-481f-a9fd-1a586746e420" />

- This command use to saves machine-readable results for automation or reporting.


### 10. Control Scan Behavior
````
whatweb --follow-redirect=never http://192.168.100.97:8080/index.php
````
<img width="895" height="80" alt="image" src="https://github.com/user-attachments/assets/a53c6901-9961-44aa-a112-e49f9126a437" />

- Don’t follow redirects.
- --follow-redirect=never: Instructs WhatWeb to not follow HTTP redirects (e.g., 301 Moved Permanently or 302 Found responses). This ensures the scan analyzes only the initially requested URL (http://192.168.100.97:8080/index.php) and stops if a redirect is encountered, reporting the redirect status instead.

````
whatweb --follow-redirect=always http://192.168.100.97:8080/index.php
````
<img width="896" height="144" alt="image" src="https://github.com/user-attachments/assets/7fd9ac6a-6f23-4d1e-a832-5e4621d67763" />

- This command always follow redirects until the final destination.


### 11. Output Filtering
````
whatweb -a 3 --colour=never http://192.168.100.97:8080/index.php
````
<img width="900" height="136" alt="image" src="https://github.com/user-attachments/assets/c81efc27-9741-4fcb-91d1-b16e55136721" />

- --colour=never: Disables colored output in the terminal. By default, WhatWeb may use colors to highlight different types of information (e.g., green for detected technologies, red for errors).



### 12. Python Script
````
#!/usr/bin/env python3

import subprocess
import sys
import os
import threading
import time
from concurrent.futures import ThreadPoolExecutor
from colorama import Fore, Style, init

# Initialize colorama
init(autoreset=True)

# Configuration
MAX_THREADS = 5
OUTPUT_DIR = "whatweb_scan_results"
URL_FILE = sys.argv[1] if len(sys.argv) > 1 else None


def check_requirements():
    """Check if whatweb is installed."""
    result = subprocess.run(["which", "whatweb"], capture_output=True, text=True)
    if result.returncode != 0:
        print(Fore.RED + "[!] 'whatweb' is not installed or not in PATH.")
        print(Fore.YELLOW + "    Install it: sudo apt install whatweb")
        sys.exit(1)


def create_output_dir():
    """Create output directory if not exists."""
    if not os.path.exists(OUTPUT_DIR):
        os.makedirs(OUTPUT_DIR)
        print(Fore.CYAN + f"[*] Created output directory: {OUTPUT_DIR}")


def read_urls(file_path):
    """Read URLs from file, one per line."""
    if not os.path.exists(file_path):
        print(Fore.RED + f"[!] URL file '{file_path}' not found!")
        sys.exit(1)

    with open(file_path, 'r') as f:
        urls = [line.strip() for line in f if line.strip() and not line.startswith('#')]
    if not urls:
        print(Fore.YELLOW + "[!] No URLs found in the file.")
        sys.exit(1)
    print(Fore.CYAN + f"[*] Loaded {len(urls)} URLs to scan.")
    return urls


def scan_url(url):
    """Run whatweb on a single URL and save result."""
    print(Fore.GREEN + f"[+] Scanning: {url}")
    safe_name = "".join(c if c.isalnum() else "_" for c in url)[:50]
    output_file = os.path.join(OUTPUT_DIR, f"{safe_name}.txt")

    try:
        # Run whatweb with verbosity level 3
        result = subprocess.run(
            ["whatweb", "-a", "3", url],
            capture_output=True,
            text=True,
            timeout=60  # 1-minute timeout per scan
        )

        with open(output_file, 'w') as f:
            f.write(f"--- WhatWeb Scan: {url} ---\n")
            f.write(f"Timestamp: {time.strftime('%Y-%m-%d %H:%M:%S')}\n")
            f.write(f"Command: whatweb -a 3 {url}\n\n")
            f.write(result.stdout)
            if result.stderr:
                f.write("\n[STDERR]\n")
                f.write(result.stderr)

        if result.returncode == 0:
            print(Fore.BLUE + f"    [✓] Done: {url} → Saved to {output_file}")
        else:
            print(Fore.RED + f"    [✗] Failed: {url}")
            with open(os.path.join(OUTPUT_DIR, "failed.txt"), "a") as fail_log:
                fail_log.write(f"{url}\n")

    except subprocess.TimeoutExpired:
        print(Fore.RED + f"    [✗] Timeout: {url}")
        with open(os.path.join(OUTPUT_DIR, "failed.txt"), "a") as fail_log:
            fail_log.write(f"[TIMEOUT] {url}\n")
    except Exception as e:
        print(Fore.RED + f"    [✗] Error scanning {url}: {str(e)}")
        with open(os.path.join(OUTPUT_DIR, "failed.txt"), "a") as fail_log:
            fail_log.write(f"[ERROR] {url}: {str(e)}\n")


def main():
    print(Fore.MAGENTA + "🔍 Starting WhatWeb Scanner..." + Style.RESET_ALL)

    if not URL_FILE:
        print(Fore.YELLOW + "Usage: python3 whatweb-scan.py <urls.txt>")
        print(Fore.YELLOW + "Example: python3 whatweb-scan.py urls.txt")
        sys.exit(1)

    check_requirements()
    create_output_dir()

    urls = read_urls(URL_FILE)

    # Use ThreadPoolExecutor for parallel scanning
    with ThreadPoolExecutor(max_workers=MAX_THREADS) as executor:
        executor.map(scan_url, urls)

    print(Fore.MAGENTA + "[*] Scan completed! Check results in './%s'" % OUTPUT_DIR)


if __name__ == "__main__":
    main()
````
<img width="643" height="365" alt="image" src="https://github.com/user-attachments/assets/324b38b4-e89c-4d6c-8cdb-b914b1c52601" />

<img width="827" height="196" alt="image" src="https://github.com/user-attachments/assets/68edf87f-ee77-419a-a377-501bb1663dea" />

### ===========>> End of whatweb

### Why Hackers Use WhatWeb:
- Technology Fingerprinting
     - Hackers need to know:
     - Which CMS (WordPress, Joomla, Drupal, etc.)
     - Which frameworks (Django, Ruby on Rails, Laravel…)
     -  Which server software (Apache, Nginx, IIS)
     - Which scripting language (PHP, ASP.NET, Node.js)
     - Which version numbers
- Vulnerability Hunting
     - If WhatWeb shows WordPress 5.7, hackers check if that version has public exploits.
     - If it shows Apache 2.4.49, they know it’s vulnerable to CVE-2021-41773 (path traversal & RCE).
     - If it shows PHPMyAdmin, they’ll try to brute-force it or look for default creds.
- Reconnaissance Before Attack
     - Hackers use WhatWeb in recon phase:
     - Before scanning with Nmap or exploiting, they use WhatWeb to reduce noise and target only vulnerable tech.
     - It’s stealthier than launching a big vulnerability scanner right away.
 


### Practice in LAB BY: Nin Kanong(k4n0ng)

#### Date: 27/Aug/2025
