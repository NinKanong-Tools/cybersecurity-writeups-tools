# Nmap Port Scanning

### What is nmap?
A basic Nmap scan identifies live hosts, open ports, and sometimes basic service information on a target IP or hostname. These scans are lightweight and suitable for beginners to understand network reconnaissance.

### LAB Tools
- Kali Linux (192.168.127.128)
- Ubuntu (192.168.127.131)
- Metasploitable2 (192.168.127.129)
- I use wireshark in ubuntu to filter traffic.


## Usages 


### 1. Basic Nmap Scan against IP or hos
- Scan specific IP
````
nmap 192.168.127.129
````
<img width="667" height="172" alt="image" src="https://github.com/user-attachments/assets/a82fe792-0bae-4f4f-b006-bea944b8c803" />

- Scan hostname:
````
nmap nmap.org
````
<img width="540" height="185" alt="image" src="https://github.com/user-attachments/assets/d154b09f-a92d-4bf3-a205-b2f858b0ed6e" />


- In wireshark:
````
icmp || arp || (tcp && ip.dst == 192.168.127.129)
````
<img width="905" height="486" alt="image" src="https://github.com/user-attachments/assets/1629575d-489f-4257-9a0a-11ed6743dd4b" />


### 2. Nmap Ping Scan
````
nmap -sp 192.168.127.129
````
<img width="884" height="134" alt="image" src="https://github.com/user-attachments/assets/43d29b24-be81-404e-a991-b328a74695ee" />


- Wireshark:
````
icmp || arp || (tcp && ip.dst == 192.168.127.129)
````
<img width="906" height="477" alt="image" src="https://github.com/user-attachments/assets/0157f3c3-674a-4d37-824b-5bf8230e9194" />

- `-sn` : Performs a host discovery scan (ping sweep) without port scanning.


### 3. Scan specific ports or scan entire port ranges on a local or remote server
````
nmap -p 1-65535 localhost
````
<img width="531" height="208" alt="image" src="https://github.com/user-attachments/assets/75800df9-22ce-4cdd-ae66-ed460098dcea" />

- `-p 1-65535` : Scans all TCP ports (1 to 65,535).
- `localhost` : Targets the loopback address (127.0.0.1), like our own machine.
- we scanned all 65535 ports for our localhost computer.

- Wireshark
````
tcp && ip.dst == 127.0.0.1
````
<img width="919" height="466" alt="image" src="https://github.com/user-attachments/assets/b49f28ab-7c8a-455d-95a8-84df4c8d5299" />

- this my localhost
<img width="616" height="558" alt="image" src="https://github.com/user-attachments/assets/24d37a02-026a-424b-9828-ddbdb019caaa" />



### 4. Scan multiple IP addresses
````
nmap 192.168.127.128 192.168.127.129
````
<img width="551" height="176" alt="image" src="https://github.com/user-attachments/assets/0666de9d-6020-44a8-9829-249b17218f08" />

````
nmap 192.168.127.128,129,131
````
<img width="606" height="207" alt="image" src="https://github.com/user-attachments/assets/562d2262-5251-4f61-8fb8-5ad505f8a0cc" />

- Scans the top 1000 TCP ports on each of the three IPs.

- Wireshark
````
ip.addr == 192.168.127.128 || ip.addr == 192.168.127.129 || ip.addr == 192.168.127.131
````
<img width="903" height="544" alt="image" src="https://github.com/user-attachments/assets/5c5f3729-e47d-4d1c-a35f-db2116122489" />

- Captures traffic to/from these IPs.
- use tcp || icmp || arp for broader capture (TCP for port scans, ICMP/ARP for host discovery).


### 5. Scan IP ranges
#### 1. scan entire CIDR IP ranges
````
nmap 192.168.127.0/24
````
<img width="545" height="255" alt="image" src="https://github.com/user-attachments/assets/13643eb4-f053-48be-9158-86e26de1f976" />

#### 2. An alternative is to simply use this kind of range:
````
nmap 192.168.127.1-135
````
<img width="532" height="258" alt="image" src="https://github.com/user-attachments/assets/d79a1ce9-b7d9-4dbc-881d-301820ff456c" />

- Scans the top 1000 TCP ports on each of the 135 IPs.

- Wireshark
````
ip.dst >= 192.168.127.1 && ip.dst <= 192.168.127.135
````
<img width="914" height="479" alt="image" src="https://github.com/user-attachments/assets/f8867534-4a47-49e1-a723-316c02f9b049" />

- Captures traffic destined for the specified IP range.

#### 3. wildcards to scan the entire C class IP range
````
nmap 192.168.127.*
````
<img width="562" height="237" alt="image" src="https://github.com/user-attachments/assets/8adb2109-02f8-4f23-86f9-1228911b1b0e" />

- Wireshark
````
ip.dst >= 192.168.127.0 && ip.dst <= 192.168.127.255
````
<img width="899" height="470" alt="image" src="https://github.com/user-attachments/assets/fe189832-b93f-4805-81a9-2409ecd32f80" />


#### 4. –exclude
````
nmap 192.168.127.0/24 --exclude 192.168.127.129
````
<img width="547" height="246" alt="image" src="https://github.com/user-attachments/assets/fecd97e8-aa1e-41fa-b1cd-c10990c16f73" />

- or we can use this command `nmap 192.168.127.0-255 --exclude 192.168.127.129` it the same.
- scan the 192.168.127.0/24 subnet (all 256 IPs) while excluding 192.168.127.129


- Wireshark
````
(ip.dst >= 192.168.127.0 && ip.dst <= 192.168.127.255) && ip.dst != 192.168.127.129
````
<img width="898" height="516" alt="image" src="https://github.com/user-attachments/assets/dc9e469c-1951-4e94-a10c-f93977bf69f7" />


### 6. Scan the most popular ports
#### 1. –top-ports” parameter along with a specific number
````
nmap --top-ports 20 192.168.127.129
````
<img width="668" height="113" alt="image" src="https://github.com/user-attachments/assets/8fd5e020-958f-45e9-8f2f-cc081afa1978" />

- Scans the top 20 TCP ports on 192.168.127.129.


- wireshark
````
ip.addr == 192.168.127.129
````
<img width="912" height="476" alt="image" src="https://github.com/user-attachments/assets/5ad88b86-628a-47f7-80db-eb848a7cb1fc" />

- Captures traffic to/from 192.168.127.129.

#### 2. find closed port
<img width="551" height="495" alt="image" src="https://github.com/user-attachments/assets/0018efeb-e044-4440-be8a-9e5a3a840e0b" />

- `--top-ports 20` : Scans the 20 most frequently used TCP ports (based on Nmap’s internal database), such as 80 (HTTP), 443 (HTTPS), 22 (SSH), 23 (Telnet), etc.
- Scans the top 20 TCP ports on 127.0.0.1.

- Wireshark
````
ip.addr == 127.0.0.1 && tcp
````
<img width="917" height="481" alt="image" src="https://github.com/user-attachments/assets/324635f6-baf3-40e1-877a-22bbad7cc803" />

- Captures TCP traffic to/from localhost.


### 7. Scan hosts and IP addresses reading from a text file
````
nano list.txt
````
````
192.168.127.128
192.168.127.129
192.168.127.131
````
<img width="200" height="43" alt="image" src="https://github.com/user-attachments/assets/c6d2c518-c051-4ad0-b9fb-06a0b3de2657" />

- Run
````
nmap -iL list.txt
````
<img width="517" height="177" alt="image" src="https://github.com/user-attachments/assets/a6133e3b-67b5-4ea4-a99a-be661e7476c3" />

- `-iL list.txt` : Tells Nmap to read a list of targets (IP addresses, hostnames, or ranges) from the file list.txt.


- Wireshark
````
ip.addr == 192.168.127.1 || ip.addr == 192.168.127.128 || ip.addr == 192.168.127.129 || ip.addr == 192.168.127.131 
````
<img width="891" height="499" alt="image" src="https://github.com/user-attachments/assets/43c57d9e-2936-4492-9780-26214eb5c0e7" />


### 8. Save your Nmap scan results to a file
#### 1. Output file txt
````
nmap -oN output.txt 192.168.127.129
cat output.txt
````
<img width="894" height="256" alt="image" src="https://github.com/user-attachments/assets/e524d575-914c-4aed-91b9-06b13d94128e" />

- `-oN output.txt` : Saves the scan results to output.txt in normal (human-readable) format.
- Scans the top 1000 TCP ports on 192.168.127.129


#### 2. Output file xml
````
nmap -oX output.xml 192.168.127.131
cat output.xml
````
<img width="914" height="651" alt="image" src="https://github.com/user-attachments/assets/c924f2b6-b384-4379-ae0c-626bc8705598" />



### 9. Disabling DNS name resolution








```
nmap -sS 192.168.100.102
```

<img width="654" height="513" alt="Screenshot from 2025-08-10 23-01-37" src="https://github.com/user-attachments/assets/ff196374-8607-4b07-a408-64bf7baaffb6" />

This command used to perform a TCP SYN scan on a single target IP address.

```
nmap -sS 192.168.100.1/24
```

<img width="586" height="430" alt="image" src="https://github.com/user-attachments/assets/e54d7b4b-8294-4be7-84ff-2b80b292520a" />


is a TCP SYN scan (also known as a stealth scan) used to identify open ports on the specified IP range.
1. -sS: This flag specifies the scan type, in this case, a TCP SYN scan (also called a "stealth scan").
2. 2. 192.168.100.1/24: This is the target specification, indicating the IP range to scan. The /24 denotes a subnet mask of 255.255.255.0, meaning Nmap will scan all IP addresses from 192.168.100.0 to 192.168.100.255 (256 addresses total).

```
nmap -iR 3 -vv
```

<img width="599" height="496" alt="image" src="https://github.com/user-attachments/assets/3b58b03a-37e4-422c-ad77-ff80917b5e29" />

This is an Nmap command that performs a scan on 3 randomly selected IPv4 addresses with increased verbosity for detailed output. Nmap is a powerful open-source tool for network discovery and security auditing. Below is a step-by-step explanation.
1. -iR 3:
   -iR: stands for "input from random" – it instructs Nmap to generate and scan random IP addresses.
    3: specifies the number of random targets (hosts) to select from the entire public IPv4 address space (approximately 4.3 billion possible addresses, excluding reserved ranges like private IPs unless configured otherwise).
Nmap avoids scanning private/reserved IPs by default to prevent accidental local network scans.
2. -vv: Double verbose mode. This increases the output detail level:
   - Shows real-time progress (e.g., packets sent/received, timing).
   - Displays more information about discoveries, such as host status, open ports, and debugging info.
   - Useful for troubleshooting or understanding the scan's inner workings. For even more detail, you could use -vvv.


  
