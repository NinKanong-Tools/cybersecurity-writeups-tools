# Rustscan 

### What sets Rustscan apart?
Rustscan is an open-source network scanner that developers created using the Rust programming language. Its lightweight design, optimized algorithms, and user-friendly interface make it a preferred choice for both penetration testers and security professionals.


### LAB TOOLS
- Kali Linux
- Metasploitable2


## Installation rustscan:
### 1. Docker Installation
````
sudo apt install doker.io
````
<img width="817" height="494" alt="image" src="https://github.com/user-attachments/assets/4cb27db8-f4a9-4dec-a652-cdcc84896535" />

````
sudo docker run -it --rm --name rustscan rustscan/rustscan:2.1.1 -a 192.168.127.129
````
<img width="840" height="701" alt="image" src="https://github.com/user-attachments/assets/ed980a43-639f-4183-ad06-00bccc4213ad" />

<img width="499" height="576" alt="image" src="https://github.com/user-attachments/assets/91faf9eb-04c5-41ed-8e3e-f25f01cc9ded" />


### 2. Installation and Usage (Standalone)
````
sudo apt install cargo
````
<img width="876" height="485" alt="image" src="https://github.com/user-attachments/assets/530f05af-b82d-42eb-8e20-1a4ad08058d9" />


````
cargo install rustscan
````
<img width="476" height="679" alt="image" src="https://github.com/user-attachments/assets/2af1f9d2-c475-4463-8f1b-dadb2f0c79ff" />

- Make sure to add the /root/.cargo/bin to the path
<img width="808" height="293" alt="image" src="https://github.com/user-attachments/assets/bc45d794-0db6-4cdd-80e1-9d55fce5483e" />

````
echo $SHELL
nano .zshrc
````
<img width="256" height="205" alt="image" src="https://github.com/user-attachments/assets/518cbfee-d950-4b19-8811-59dc9f126359" />

- Add the /root/.cargo/bin as export PATH.
<img width="841" height="296" alt="image" src="https://github.com/user-attachments/assets/1b3a979c-9720-42ea-810b-c27fc83ff102" />

- After installation success, Rustscan is now ready to run.

````
source .zshrc
````
<img width="267" height="66" alt="image" src="https://github.com/user-attachments/assets/78f1cc2f-3e0d-40dd-80b3-e068ff841ba1" />

- if we can'r run rustscan like this:
<img width="614" height="546" alt="image" src="https://github.com/user-attachments/assets/fe1e1fed-dbce-4125-bf31-15d90df6242c" />

 - just install rust:
````
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
````
<img width="703" height="636" alt="image" src="https://github.com/user-attachments/assets/229aa5ba-eefd-4043-8316-52a570eac0f3" />

- Reload your shell:
````
source $HOME/.cargo/env
cargo install rustscan
````
<img width="501" height="598" alt="image" src="https://github.com/user-attachments/assets/ec52ad2e-c9df-4902-b44e-7e996bb7967e" />

- verify
````
rustscan --version
````
<img width="274" height="67" alt="image" src="https://github.com/user-attachments/assets/d21db9e4-f8ac-4b5b-9031-944cba8adf23" />

- Test:
````
rustscan
````
<img width="579" height="269" alt="image" src="https://github.com/user-attachments/assets/b44ccf52-21df-410f-803e-dbb4e1c6c6f3" />


## Usage:
- -a : To perform a comprehensive scan of all TCP ports.

| Option                                        | Description                                                                       |
| --------------------------------------------- | --------------------------------------------------------------------------------- |
| `-a, --addresses <ADDRESSES>`                 | A comma-delimited list or newline-delimited file of CIDRs, IPs, or hosts to scan. |
| `-p, --ports <PORTS>`                         | Comma-separated list of ports to scan (e.g., `80,443,8080`).                      |
| `-r, --range <RANGE>`                         | Range of ports in format `start-end` (e.g., `1-1000`).                            |
| `-n, --no-config`                             | Ignore the configuration file.                                                    |
| `--no-banner`                                 | Hide the RustScan banner.                                                         |
| `-c, --config-path <CONFIG_PATH>`             | Use a custom path to a config file.                                               |
| `-g, --greppable`                             | Greppable mode: only outputs ports (no Nmap), useful for piping/grep.             |
| `--accessible`                                | Accessible mode: disables features that affect screen readers.                    |
| `--resolver <RESOLVER>`                       | Comma-delimited list or file of DNS resolvers.                                    |
| `-b, --batch-size <BATCH_SIZE>`               | Batch size for port scanning. Controls speed. Default = 4500.                     |
| `-t, --timeout <TIMEOUT>`                     | Timeout (ms) before assuming a port is closed. Default = 1500.                    |
| `--tries <TRIES>`                             | Number of tries before a port is assumed closed. Default = 1 (min = 1).           |
| `-u, --ulimit <ULIMIT>`                       | Automatically increase ULIMIT to the given value.                                 |
| `--scan-order <SCAN_ORDER>`                   | Order of scanning: `serial` (ascending) or `random`. Default = serial.            |
| `--scripts <SCRIPTS>`                         | Level of scripting: `none`, `default`, or `custom`. Default = default.            |
| `--top`                                       | Scan top 1000 ports.                                                              |
| `-e, --exclude-ports <EXCLUDE_PORTS>`         | Comma-separated ports to exclude from scanning.                                   |
| `-x, --exclude-addresses <EXCLUDE_ADDRESSES>` | Comma-separated list of hosts/CIDRs to exclude.                                   |
| `--udp`                                       | Enable UDP scanning mode (detects responsive UDP ports).                          |
| `-h, --help`                                  | Print help message.                                                               |
| `-V, --version`                               | Print version of RustScan.                                                        |


### 1. Scan All TCP Ports on a Target
````
rustscan -a 192.168.127.129
````
<img width="914" height="631" alt="image" src="https://github.com/user-attachments/assets/bcb48380-68fe-414b-b8f2-4982bb55c607" />

<img width="785" height="738" alt="image" src="https://github.com/user-attachments/assets/14f8dd7f-2b11-4bc2-806f-8d1d18c8eff4" />

<img width="543" height="600" alt="image" src="https://github.com/user-attachments/assets/fd9e985e-7054-43eb-8d20-c1f1e9a55115" />

- Scans all ports of the target IP. By default, RustScan is very fast.


### 2. Scan Specific Ports
````
rustscan -a 192.168.127.129 -p 22,80,443
````
<img width="903" height="754" alt="image" src="https://github.com/user-attachments/assets/e8e2de4e-c50a-4fe1-9913-23cb61e228dc" />

- -p : To define specific ports to be scanned.
- Only scan ports 22 (SSH), 80 (HTTP), and 443 (HTTPS).


### 3. Scan a Range of Ports
````
rustscan -a 192.168.127.129 --range 1-1000
````
<img width="887" height="724" alt="image" src="https://github.com/user-attachments/assets/142dcb2a-c3f9-4ea5-b45e-9d249135beba" />

<img width="568" height="315" alt="image" src="https://github.com/user-attachments/assets/6c5a77d8-a791-4052-8434-1e8fd7e1f4ff" />

- `--range 1-1000`: Defines the port range to scan, from port 1 to 1000 (inclusive).
- Scans ports 1–1000 only. Useful if you want to limit your scan.


### 4. Scan a Subnet
````
rustscan -a 192.168.127.0/24
````
<img width="896" height="569" alt="image" src="https://github.com/user-attachments/assets/730c7668-744e-4f5e-adc5-c1db6d9656d2" />

- Scans every device in the 192.168.127.129 network.
- In this it spend a long time, depend on computer but in this it need to spend more time show i screenshot only this.


### 5. Control Speed (Batch Size)
````
rustscan -a 192.168.127.129 -b 1000
````
<img width="743" height="715" alt="image" src="https://github.com/user-attachments/assets/38ca170a-665b-49d1-b0d7-a868af1a2a7a" />

<img width="803" height="701" alt="image" src="https://github.com/user-attachments/assets/4e9c2938-8865-4731-9a82-6f956439f73b" />

<img width="524" height="598" alt="image" src="https://github.com/user-attachments/assets/f729af94-4566-4d71-b762-7eadf71e10a7" />

- Sets batch size to 1000 packets/second (default = 3000). Lower for stealth, higher for speed.



### 6. Output in Greppable Format
````
rustscan -a 192.168.127.129 -g
````
<img width="899" height="85" alt="image" src="https://github.com/user-attachments/assets/f52b9c04-f0bf-4737-97a1-c0dc8fb630ae" />

- Gives results in a simple machine-readable format, easy for automation.


### 7. accessibility Mode
````
rustscan -a 192.168.127.129 --accessible
````
<img width="898" height="651" alt="image" src="https://github.com/user-attachments/assets/b617495e-2e18-4b3c-b330-6bcc20787f45" />

<img width="566" height="566" alt="image" src="https://github.com/user-attachments/assets/f2413b65-ad80-4936-8599-9181ccaefd9c" />

<img width="552" height="597" alt="image" src="https://github.com/user-attachments/assets/7337b136-707c-4e72-ac84-d0bff405d334" />

- Simplified output, good for screen readers or minimal display.


### 8. Pass Results to Nmap (Service Detection & Scripts)
````
rustscan -a 192.168.127.129 -- -sC -sV
````
<img width="917" height="754" alt="image" src="https://github.com/user-attachments/assets/874fc389-1a85-4f36-81f7-f2f53cff23a2" />

- Then, you can see the results of the service version and default script scan below.

<img width="823" height="735" alt="image" src="https://github.com/user-attachments/assets/e78a90a5-8e02-4044-b2cd-f75a67bfc4cd" />

<img width="885" height="730" alt="image" src="https://github.com/user-attachments/assets/7a2e4877-ade6-478c-8d31-2d21c7302f7a" />

<img width="778" height="720" alt="image" src="https://github.com/user-attachments/assets/8af98bde-a37e-485c-b51e-c725b6d192e2" />

<img width="791" height="714" alt="image" src="https://github.com/user-attachments/assets/8027167a-20df-4ca4-9562-7ff682c22f38" />

- `-sC -sV` : To perform default script scan and service version scan.
- RustScan finds open ports ->  sends them to Nmap for:
    - `-sC` = Run default scripts
    - `-sV` = Detect service version



### 9. Aggressive Nmap Scan via RustScan
````
rustscan -a 192.168.127.129 -- -A
````
<img width="895" height="752" alt="image" src="https://github.com/user-attachments/assets/87ae9b7e-6c60-42ea-99e7-966ce182ff4b" />

<img width="786" height="714" alt="image" src="https://github.com/user-attachments/assets/db7bd6f2-18e7-44ae-bdbe-1274d073d7dc" />

<img width="898" height="698" alt="image" src="https://github.com/user-attachments/assets/5332ce23-b565-4078-98a5-959c0373627f" />

<img width="772" height="708" alt="image" src="https://github.com/user-attachments/assets/0adefde5-7826-43e8-aaa8-c9a541da6f2d" />

<img width="824" height="739" alt="image" src="https://github.com/user-attachments/assets/e165cc20-3982-443e-8939-d1de03e34b66" />

- After scanning, Nmap does OS detection, version detection, script scanning, traceroute.
- `--` : Indicates that all following arguments are passed as raw arguments to a command executed after the scan.
- `-A` : A flag typically used with nmap to enable OS detection, version scanning, script scanning, and traceroute.


### 10. Save Output to a File
````
rustscan -a 192.168.127.129 -- -o scan.txt
````
<img width="908" height="750" alt="image" src="https://github.com/user-attachments/assets/9988a679-46a2-42ab-b48c-a2499ecf5622" />

<img width="831" height="735" alt="image" src="https://github.com/user-attachments/assets/a6d2dbb0-8043-4bf6-bc21-ae76d3639a29" />

<img width="538" height="607" alt="image" src="https://github.com/user-attachments/assets/fa359582-255c-47f0-9735-7b4a0ee161fd" />

- check file scan.txt
````
cat scan.txt
````
<img width="854" height="693" alt="image" src="https://github.com/user-attachments/assets/b169e9e1-719e-48db-9a3e-c015840427f0" />

- Thia command saves results into scan.txt.
- `-o scan.txt` : Intended to output results to a file named scan.txt, but placed after --, which causes it to be interpreted as an argument for the follow-up tool (e.g., nmap) rather than rustscan.


### 11. Scan port 21-50
````
rustscan -a 192.168.127.129 -r 21-50
````
<img width="711" height="656" alt="image" src="https://github.com/user-attachments/assets/3f045048-5792-44b4-b6a3-bdf0b66661d5" />

- `-r 21-50` : Scan only ports in the range 21 to 50.
- This command will test for open ports 21 → 50 on that machine (FTP, SSH, Telnet, SMTP, DNS, etc. depending on services running).


#### We can also combine it with Nmap for service detection:
````
rustscan -a 192.168.127.129 -r 21-50 -- -sV
````
<img width="743" height="737" alt="image" src="https://github.com/user-attachments/assets/117c743a-0f58-43ab-b84e-7fd2306425a2" />

<img width="713" height="200" alt="image" src="https://github.com/user-attachments/assets/3638e6fb-4626-48bc-888c-8e6ce09e3bef" />

- It will scans ports 21–50, then runs Nmap -sV (service version detection) on any open ones.




### 12. ulimit
````
rustscan -a 192.168.127.129 --ulimit 5000
````
<img width="549" height="657" alt="image" src="https://github.com/user-attachments/assets/f828574e-a9ce-4437-bac0-ba049a3e9f16" />

<img width="689" height="670" alt="image" src="https://github.com/user-attachments/assets/2b33ffd2-e4e2-4463-a6e4-49a3512a7ee6" />

<img width="483" height="576" alt="image" src="https://github.com/user-attachments/assets/ea4a9d87-6c24-46bf-8096-22b263cfdce5" />

- This scans all 65535 TCP ports on host 192.168.127.129 very quickly.
- `--ulimit 5000` : Increases the open file descriptors limit to 5000

#### 1. We can combine it with nmap:
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -sV -sC
````
<img width="586" height="740" alt="image" src="https://github.com/user-attachments/assets/9031cb9e-ff5a-43bb-ad5e-20828d5cbd1d" />

<img width="801" height="745" alt="image" src="https://github.com/user-attachments/assets/69411e76-823e-48f9-89fd-2ebf3c877e0b" />

<img width="905" height="749" alt="image" src="https://github.com/user-attachments/assets/bb3c7efe-ed12-43a1-87de-3ca220f38d8b" />

<img width="770" height="765" alt="image" src="https://github.com/user-attachments/assets/90a1df91-ace7-40ab-8517-9ee51527308d" />

<img width="837" height="685" alt="image" src="https://github.com/user-attachments/assets/86cbd167-0a1d-4891-ac75-c57954cb4e4b" />

- `--` : Pass arguments directly to Nmap

#### 2. Aggressive Recon
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -A -O
````
<img width="561" height="701" alt="image" src="https://github.com/user-attachments/assets/b039f072-c260-47a3-abf4-39cf93bbe5ea" />

<img width="725" height="758" alt="image" src="https://github.com/user-attachments/assets/cf9d29ee-080b-439e-a28a-99ff726e18ae" />

<img width="902" height="688" alt="image" src="https://github.com/user-attachments/assets/e0635aaa-f76c-4418-bad4-d3de23a6ae4d" />

<img width="766" height="762" alt="image" src="https://github.com/user-attachments/assets/9a532b94-1fa4-4229-94a0-316d032096a6" />

- `-O` : OS fingerprinting



### 3. Stealth Scan (Avoid Detection)
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -sS -Pn
````
<img width="675" height="695" alt="image" src="https://github.com/user-attachments/assets/174beee5-579b-4434-b5b5-ad8244d4ac0f" />

<img width="693" height="706" alt="image" src="https://github.com/user-attachments/assets/1035a0ba-b8a6-4a8f-9b8b-c7ca5dffbac2" />

<img width="449" height="570" alt="image" src="https://github.com/user-attachments/assets/3ae6665d-88bf-4802-a4bb-dd2e581faecf" />

- `-sS` : TCP SYN scan (half-open, stealthy)
- `-Pn` → Don’t ping, treat host as alive



#### 4. Web App Hunting
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -sV --script=http-enum
````
<img width="526" height="684" alt="image" src="https://github.com/user-attachments/assets/003bb55b-893b-4a10-b836-1d65ef7f0d80" />

<img width="778" height="698" alt="image" src="https://github.com/user-attachments/assets/5582f8fd-8cef-4bd1-b9b8-60961a9d2858" />

<img width="689" height="725" alt="image" src="https://github.com/user-attachments/assets/3b4dd1e7-4aab-4632-8218-97dd9749977d" />

<img width="882" height="649" alt="image" src="https://github.com/user-attachments/assets/00b1e6fc-70ce-4f54-967e-e6c149964f14" />

- Detects hidden web directories and applications.


#### 5. Web App Recon 
````
rustscan -a 192.168.1.7 -- -sV --script=http-enum
````
<img width="899" height="735" alt="image" src="https://github.com/user-attachments/assets/8ca2b5e6-bacf-454f-baae-33f5b7d6b3db" />












