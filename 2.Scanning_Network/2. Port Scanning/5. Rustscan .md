# Rustscan 

<img width="1200" height="800" alt="rustscan_1" src="https://github.com/user-attachments/assets/81b4a70e-a5a8-4904-975f-6086e9b63723" />

### What sets Rustscan apart?
Rustscan is an open-source network scanner that developers created using the Rust programming language. Its lightweight design, optimized algorithms, and user-friendly interface make it a preferred choice for both penetration testers and security professionals.


### LAB TOOLS
- Kali Linux (192.168.127.128)
- Metasploitable2 (192.168.127.129)


## Installation rustscan:
### 1. Docker Installation
````
sudo apt install doker.io
````
<img width="817" height="494" alt="image" src="https://github.com/user-attachments/assets/4cb27db8-f4a9-4dec-a652-cdcc84896535" />

````
sudo docker run -it --rm --name rustscan rustscan/rustscan:2.1.1 -a 192.168.127.129
````
<img width="840" height="701" alt="image" src="https://github.com/user-attachments/assets/ed980a43-639f-4183-ad06-00bccc4213ad" />

<img width="499" height="576" alt="image" src="https://github.com/user-attachments/assets/91faf9eb-04c5-41ed-8e3e-f25f01cc9ded" />


### 2. Installation and Usage (Standalone)
````
sudo apt install cargo
````
<img width="876" height="485" alt="image" src="https://github.com/user-attachments/assets/530f05af-b82d-42eb-8e20-1a4ad08058d9" />


````
cargo install rustscan
````
<img width="476" height="679" alt="image" src="https://github.com/user-attachments/assets/2af1f9d2-c475-4463-8f1b-dadb2f0c79ff" />

- Make sure to add the /root/.cargo/bin to the path
<img width="808" height="293" alt="image" src="https://github.com/user-attachments/assets/bc45d794-0db6-4cdd-80e1-9d55fce5483e" />

````
echo $SHELL
nano .zshrc
````
<img width="256" height="205" alt="image" src="https://github.com/user-attachments/assets/518cbfee-d950-4b19-8811-59dc9f126359" />

- Add the /root/.cargo/bin as export PATH.
<img width="841" height="296" alt="image" src="https://github.com/user-attachments/assets/1b3a979c-9720-42ea-810b-c27fc83ff102" />

- After installation success, Rustscan is now ready to run.

````
source .zshrc
````
<img width="267" height="66" alt="image" src="https://github.com/user-attachments/assets/78f1cc2f-3e0d-40dd-80b3-e068ff841ba1" />

- if we can'r run rustscan like this:
<img width="614" height="546" alt="image" src="https://github.com/user-attachments/assets/fe1e1fed-dbce-4125-bf31-15d90df6242c" />

 - just install rust:
````
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
````
<img width="703" height="636" alt="image" src="https://github.com/user-attachments/assets/229aa5ba-eefd-4043-8316-52a570eac0f3" />

- Reload your shell:
````
source $HOME/.cargo/env
cargo install rustscan
````
<img width="501" height="598" alt="image" src="https://github.com/user-attachments/assets/ec52ad2e-c9df-4902-b44e-7e996bb7967e" />

- verify
````
rustscan --version
````
<img width="274" height="67" alt="image" src="https://github.com/user-attachments/assets/d21db9e4-f8ac-4b5b-9031-944cba8adf23" />

- Test:
````
rustscan
````
<img width="579" height="269" alt="image" src="https://github.com/user-attachments/assets/b44ccf52-21df-410f-803e-dbb4e1c6c6f3" />


## Usage:
- -a : To perform a comprehensive scan of all TCP ports.

| Option                                        | Description                                                                       |
| --------------------------------------------- | --------------------------------------------------------------------------------- |
| `-a, --addresses <ADDRESSES>`                 | A comma-delimited list or newline-delimited file of CIDRs, IPs, or hosts to scan. |
| `-p, --ports <PORTS>`                         | Comma-separated list of ports to scan (e.g., `80,443,8080`).                      |
| `-r, --range <RANGE>`                         | Range of ports in format `start-end` (e.g., `1-1000`).                            |
| `-n, --no-config`                             | Ignore the configuration file.                                                    |
| `--no-banner`                                 | Hide the RustScan banner.                                                         |
| `-c, --config-path <CONFIG_PATH>`             | Use a custom path to a config file.                                               |
| `-g, --greppable`                             | Greppable mode: only outputs ports (no Nmap), useful for piping/grep.             |
| `--accessible`                                | Accessible mode: disables features that affect screen readers.                    |
| `--resolver <RESOLVER>`                       | Comma-delimited list or file of DNS resolvers.                                    |
| `-b, --batch-size <BATCH_SIZE>`               | Batch size for port scanning. Controls speed. Default = 4500.                     |
| `-t, --timeout <TIMEOUT>`                     | Timeout (ms) before assuming a port is closed. Default = 1500.                    |
| `--tries <TRIES>`                             | Number of tries before a port is assumed closed. Default = 1 (min = 1).           |
| `-u, --ulimit <ULIMIT>`                       | Automatically increase ULIMIT to the given value.                                 |
| `--scan-order <SCAN_ORDER>`                   | Order of scanning: `serial` (ascending) or `random`. Default = serial.            |
| `--scripts <SCRIPTS>`                         | Level of scripting: `none`, `default`, or `custom`. Default = default.            |
| `--top`                                       | Scan top 1000 ports.                                                              |
| `-e, --exclude-ports <EXCLUDE_PORTS>`         | Comma-separated ports to exclude from scanning.                                   |
| `-x, --exclude-addresses <EXCLUDE_ADDRESSES>` | Comma-separated list of hosts/CIDRs to exclude.                                   |
| `--udp`                                       | Enable UDP scanning mode (detects responsive UDP ports).                          |
| `-h, --help`                                  | Print help message.                                                               |
| `-V, --version`                               | Print version of RustScan.                                                        |


### 1. Scan All TCP Ports on a Target
````
rustscan -a 192.168.127.129
````
<img width="914" height="631" alt="image" src="https://github.com/user-attachments/assets/bcb48380-68fe-414b-b8f2-4982bb55c607" />

<img width="785" height="738" alt="image" src="https://github.com/user-attachments/assets/14f8dd7f-2b11-4bc2-806f-8d1d18c8eff4" />

<img width="543" height="600" alt="image" src="https://github.com/user-attachments/assets/fd9e985e-7054-43eb-8d20-c1f1e9a55115" />

- Scans all ports of the target IP. By default, RustScan is very fast.


### 2. Scan Specific Ports
````
rustscan -a 192.168.127.129 -p 22,80,443
````
<img width="903" height="754" alt="image" src="https://github.com/user-attachments/assets/e8e2de4e-c50a-4fe1-9913-23cb61e228dc" />

- -p : To define specific ports to be scanned.
- Only scan ports 22 (SSH), 80 (HTTP), and 443 (HTTPS).


### 3. Scan a Range of Ports
````
rustscan -a 192.168.127.129 --range 1-1000
````
<img width="887" height="724" alt="image" src="https://github.com/user-attachments/assets/142dcb2a-c3f9-4ea5-b45e-9d249135beba" />

<img width="568" height="315" alt="image" src="https://github.com/user-attachments/assets/6c5a77d8-a791-4052-8434-1e8fd7e1f4ff" />

- `--range 1-1000`: Defines the port range to scan, from port 1 to 1000 (inclusive).
- Scans ports 1â€“1000 only. Useful if you want to limit your scan.


### 4. Scan a Subnet
````
rustscan -a 192.168.127.0/24
````
<img width="896" height="569" alt="image" src="https://github.com/user-attachments/assets/730c7668-744e-4f5e-adc5-c1db6d9656d2" />

- Scans every device in the 192.168.127.129 network.
- In this it spend a long time, depend on computer but in this it need to spend more time show i screenshot only this.


### 5. Control Speed (Batch Size)
````
rustscan -a 192.168.127.129 -b 1000
````
<img width="743" height="715" alt="image" src="https://github.com/user-attachments/assets/38ca170a-665b-49d1-b0d7-a868af1a2a7a" />

<img width="803" height="701" alt="image" src="https://github.com/user-attachments/assets/4e9c2938-8865-4731-9a82-6f956439f73b" />

<img width="524" height="598" alt="image" src="https://github.com/user-attachments/assets/f729af94-4566-4d71-b762-7eadf71e10a7" />

- Sets batch size to 1000 packets/second (default = 3000). Lower for stealth, higher for speed.



### 6. Output in Greppable Format
````
rustscan -a 192.168.127.129 -g
````
<img width="899" height="85" alt="image" src="https://github.com/user-attachments/assets/f52b9c04-f0bf-4737-97a1-c0dc8fb630ae" />

- Gives results in a simple machine-readable format, easy for automation.


### 7. accessibility Mode
````
rustscan -a 192.168.127.129 --accessible
````
<img width="898" height="651" alt="image" src="https://github.com/user-attachments/assets/b617495e-2e18-4b3c-b330-6bcc20787f45" />

<img width="566" height="566" alt="image" src="https://github.com/user-attachments/assets/f2413b65-ad80-4936-8599-9181ccaefd9c" />

<img width="552" height="597" alt="image" src="https://github.com/user-attachments/assets/7337b136-707c-4e72-ac84-d0bff405d334" />

- Simplified output, good for screen readers or minimal display.


### 8. Pass Results to Nmap (Service Detection & Scripts)
````
rustscan -a 192.168.127.129 -- -sC -sV
````
<img width="917" height="754" alt="image" src="https://github.com/user-attachments/assets/874fc389-1a85-4f36-81f7-f2f53cff23a2" />

- Then, you can see the results of the service version and default script scan below.

<img width="823" height="735" alt="image" src="https://github.com/user-attachments/assets/e78a90a5-8e02-4044-b2cd-f75a67bfc4cd" />

<img width="885" height="730" alt="image" src="https://github.com/user-attachments/assets/7a2e4877-ade6-478c-8d31-2d21c7302f7a" />

<img width="778" height="720" alt="image" src="https://github.com/user-attachments/assets/8af98bde-a37e-485c-b51e-c725b6d192e2" />

<img width="791" height="714" alt="image" src="https://github.com/user-attachments/assets/8027167a-20df-4ca4-9562-7ff682c22f38" />

- `-sC -sV` : To perform default script scan and service version scan.
- RustScan finds open ports ->  sends them to Nmap for:
    - `-sC` = Run default scripts
    - `-sV` = Detect service version



### 9. Aggressive Nmap Scan via RustScan
````
rustscan -a 192.168.127.129 -- -A
````
<img width="895" height="752" alt="image" src="https://github.com/user-attachments/assets/87ae9b7e-6c60-42ea-99e7-966ce182ff4b" />

<img width="786" height="714" alt="image" src="https://github.com/user-attachments/assets/db7bd6f2-18e7-44ae-bdbe-1274d073d7dc" />

<img width="898" height="698" alt="image" src="https://github.com/user-attachments/assets/5332ce23-b565-4078-98a5-959c0373627f" />

<img width="772" height="708" alt="image" src="https://github.com/user-attachments/assets/0adefde5-7826-43e8-aaa8-c9a541da6f2d" />

<img width="824" height="739" alt="image" src="https://github.com/user-attachments/assets/e165cc20-3982-443e-8939-d1de03e34b66" />

- After scanning, Nmap does OS detection, version detection, script scanning, traceroute.
- `--` : Indicates that all following arguments are passed as raw arguments to a command executed after the scan.
- `-A` : A flag typically used with nmap to enable OS detection, version scanning, script scanning, and traceroute.


### 10. Save Output to a File
````
rustscan -a 192.168.127.129 -- -o scan.txt
````
<img width="908" height="750" alt="image" src="https://github.com/user-attachments/assets/9988a679-46a2-42ab-b48c-a2499ecf5622" />

<img width="831" height="735" alt="image" src="https://github.com/user-attachments/assets/a6d2dbb0-8043-4bf6-bc21-ae76d3639a29" />

<img width="538" height="607" alt="image" src="https://github.com/user-attachments/assets/fa359582-255c-47f0-9735-7b4a0ee161fd" />

- check file scan.txt
````
cat scan.txt
````
<img width="854" height="693" alt="image" src="https://github.com/user-attachments/assets/b169e9e1-719e-48db-9a3e-c015840427f0" />

- Thia command saves results into scan.txt.
- `-o scan.txt` : Intended to output results to a file named scan.txt, but placed after --, which causes it to be interpreted as an argument for the follow-up tool (e.g., nmap) rather than rustscan.


### 11. Scan port 21-50
````
rustscan -a 192.168.127.129 -r 21-50
````
<img width="711" height="656" alt="image" src="https://github.com/user-attachments/assets/3f045048-5792-44b4-b6a3-bdf0b66661d5" />

- `-r 21-50` : Scan only ports in the range 21 to 50.
- This command will test for open ports 21 â†’ 50 on that machine (FTP, SSH, Telnet, SMTP, DNS, etc. depending on services running).


#### We can also combine it with Nmap for service detection:
````
rustscan -a 192.168.127.129 -r 21-50 -- -sV
````
<img width="743" height="737" alt="image" src="https://github.com/user-attachments/assets/117c743a-0f58-43ab-b84e-7fd2306425a2" />

<img width="713" height="200" alt="image" src="https://github.com/user-attachments/assets/3638e6fb-4626-48bc-888c-8e6ce09e3bef" />

- It will scans ports 21â€“50, then runs Nmap -sV (service version detection) on any open ones.




### 12. ulimit
````
rustscan -a 192.168.127.129 --ulimit 5000
````
<img width="549" height="657" alt="image" src="https://github.com/user-attachments/assets/f828574e-a9ce-4437-bac0-ba049a3e9f16" />

<img width="689" height="670" alt="image" src="https://github.com/user-attachments/assets/2b33ffd2-e4e2-4463-a6e4-49a3512a7ee6" />

<img width="483" height="576" alt="image" src="https://github.com/user-attachments/assets/ea4a9d87-6c24-46bf-8096-22b263cfdce5" />

- This scans all 65535 TCP ports on host 192.168.127.129 very quickly.
- `--ulimit 5000` : Increases the open file descriptors limit to 5000

#### 1. We can combine it with nmap:
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -sV -sC
````
<img width="586" height="740" alt="image" src="https://github.com/user-attachments/assets/9031cb9e-ff5a-43bb-ad5e-20828d5cbd1d" />

<img width="801" height="745" alt="image" src="https://github.com/user-attachments/assets/69411e76-823e-48f9-89fd-2ebf3c877e0b" />

<img width="905" height="749" alt="image" src="https://github.com/user-attachments/assets/bb3c7efe-ed12-43a1-87de-3ca220f38d8b" />

<img width="770" height="765" alt="image" src="https://github.com/user-attachments/assets/90a1df91-ace7-40ab-8517-9ee51527308d" />

<img width="837" height="685" alt="image" src="https://github.com/user-attachments/assets/86cbd167-0a1d-4891-ac75-c57954cb4e4b" />

- `--` : Pass arguments directly to Nmap

#### 2. Aggressive Recon
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -A -O
````
<img width="561" height="701" alt="image" src="https://github.com/user-attachments/assets/b039f072-c260-47a3-abf4-39cf93bbe5ea" />

<img width="725" height="758" alt="image" src="https://github.com/user-attachments/assets/cf9d29ee-080b-439e-a28a-99ff726e18ae" />

<img width="902" height="688" alt="image" src="https://github.com/user-attachments/assets/e0635aaa-f76c-4418-bad4-d3de23a6ae4d" />

<img width="766" height="762" alt="image" src="https://github.com/user-attachments/assets/9a532b94-1fa4-4229-94a0-316d032096a6" />

- `-O` : OS fingerprinting



### 3. Stealth Scan (Avoid Detection)
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -sS -Pn
````
<img width="675" height="695" alt="image" src="https://github.com/user-attachments/assets/174beee5-579b-4434-b5b5-ad8244d4ac0f" />

<img width="693" height="706" alt="image" src="https://github.com/user-attachments/assets/1035a0ba-b8a6-4a8f-9b8b-c7ca5dffbac2" />

<img width="449" height="570" alt="image" src="https://github.com/user-attachments/assets/3ae6665d-88bf-4802-a4bb-dd2e581faecf" />

- `-sS` : TCP SYN scan (half-open, stealthy)
- `-Pn` â†’ Donâ€™t ping, treat host as alive



#### 4. Web App Hunting
````
rustscan -a 192.168.127.129 --ulimit 5000 -- -sV --script=http-enum
````
<img width="526" height="684" alt="image" src="https://github.com/user-attachments/assets/003bb55b-893b-4a10-b836-1d65ef7f0d80" />

<img width="778" height="698" alt="image" src="https://github.com/user-attachments/assets/5582f8fd-8cef-4bd1-b9b8-60961a9d2858" />

<img width="689" height="725" alt="image" src="https://github.com/user-attachments/assets/3b4dd1e7-4aab-4632-8218-97dd9749977d" />

<img width="882" height="649" alt="image" src="https://github.com/user-attachments/assets/00b1e6fc-70ce-4f54-967e-e6c149964f14" />

- Detects hidden web directories and applications.


### 13. Web App Recon 
````
rustscan -a 192.168.127.129 -- -sV --script=http-enum
````
<img width="899" height="735" alt="image" src="https://github.com/user-attachments/assets/8ca2b5e6-bacf-454f-baae-33f5b7d6b3db" />

<img width="885" height="748" alt="image" src="https://github.com/user-attachments/assets/90a94051-e019-4895-b482-20f738c07d52" />

<img width="778" height="753" alt="image" src="https://github.com/user-attachments/assets/01e24425-660c-479f-a0ff-18893d95b36c" />

<img width="890" height="350" alt="image" src="https://github.com/user-attachments/assets/43211bdc-9f84-4b79-82e1-cf90c5ee67a9" />

- Quickly finds hidden web directories and services.
- `--script=http-enum` : An nmap NSE (Nmap Scripting Engine) script that enumerates HTTP directories, files, and virtual hosts by testing common paths and patterns.
- `-sV` : An nmap option to enable version detection, identifying the service and version running on open ports.



## 14. RustScan Commands (Hacker Mode)
#### 1. 1. Full TCP + Aggressive Enumeration
````
rustscan -a 192.168.127.129 -r 1-65535 --ulimit 10000 -- -sC -sV -A -O
````
<img width="560" height="686" alt="image" src="https://github.com/user-attachments/assets/d9acdca3-b36c-4eab-88c5-330910c860b2" />

<img width="721" height="748" alt="image" src="https://github.com/user-attachments/assets/8bca9297-6062-4748-80e7-6d00a0a97c1e" />

<img width="729" height="701" alt="image" src="https://github.com/user-attachments/assets/b3b6dade-b6a9-4cbf-adfd-63e4389f8758" />

- `-r 1-65535` : scan all ports
- `--ulimit 10000` : max speed
- `-sC` : default NSE scripts
- `-sV` : service version detection
- `-A`: aggressive mode (OS, traceroute, scripts)
- `-O` : OS fingerprinting.
- This command is designed for a thorough network reconnaissance and vulnerability assessment of the target IP 192.168.127.129.


#### 2. Stealth Scan + Evade Firewalls
````
rustscan -a 192.168.127.129 -- -sS -Pn --scan-delay 200ms --max-retries 2
````
<img width="894" height="720" alt="image" src="https://github.com/user-attachments/assets/9e43b988-a36b-48f6-b31d-ecd11d9a17f1" />

<img width="895" height="711" alt="image" src="https://github.com/user-attachments/assets/bb4ffa73-2762-43c3-878c-48e13ffde095" />

<img width="457" height="550" alt="image" src="https://github.com/user-attachments/assets/1500ad01-ff02-4c03-bd6c-fb20ab3548d1" />


- `-sS` : stealth SYN scan (half-open).
- `-Pn` : donâ€™t ping first (avoid firewalls blocking ICMP).
- `--scan-delay` : slows scans to bypass IDS.
- `--max-retries 2` : avoid noisy repeated attempts.
- This command is designed for a stealthy and controlled port scan and avoiding detection.


#### 3. Entire Subnet Fast Sweep
````
rustscan -a 192.168.127.0/24 --ulimit 5000 -- -sS -sV -T4
````
<img width="529" height="612" alt="image" src="https://github.com/user-attachments/assets/ee8e74d5-78a1-4172-835b-cda60379567b" />

- In this i will spend a long time.
- `-T4` : Sets an aggressive timing template, balancing speed and reliability.
- This command will finds all live hosts & open ports on subnet and then fingerprints services.



#### 4. Specific Service Targeting
````
rustscan -a 192.168.127.129 -p 21,22,25,80,110,139,445,1433,3306,3389,5900,8080 -- -sV --script=vuln
````
<img width="864" height="718" alt="image" src="https://github.com/user-attachments/assets/2f0ab602-21e2-46b9-b88a-8cdd52ff79a1" />

<img width="906" height="715" alt="image" src="https://github.com/user-attachments/assets/cc68d5fa-aff2-4a78-b571-bd92f2bb908b" />

<img width="908" height="731" alt="image" src="https://github.com/user-attachments/assets/4d77bbdf-03ff-4d8f-81d5-4299d7c26f23" />

<img width="880" height="727" alt="image" src="https://github.com/user-attachments/assets/87bcb498-c38d-423d-9b17-d4a207097956" />

<img width="702" height="611" alt="image" src="https://github.com/user-attachments/assets/cee44311-f21a-4805-a619-cab930d2d182" />

- Scans common exploitable services + runs NSE vuln scripts.


#### 5. Save for Exploitation
````
rustscan -a 192.168.127.129 -- -sV -oA target_scan
````
<img width="895" height="747" alt="image" src="https://github.com/user-attachments/assets/68a4cabe-b91e-4fa4-88e7-2eae4947ca41" />

<img width="882" height="714" alt="image" src="https://github.com/user-attachments/assets/7a7149f3-c178-4472-879b-db861f4b2f94" />

<img width="887" height="652" alt="image" src="https://github.com/user-attachments/assets/e45b2ad1-8941-4dc0-b4b7-118558b31052" />

- To view file:
````
cat target_scan.nmap
````
<img width="907" height="699" alt="image" src="https://github.com/user-attachments/assets/b8c11aec-a395-452c-b0ad-ed337080e5ec" />

<img width="778" height="75" alt="image" src="https://github.com/user-attachments/assets/d7e9e674-2916-45f9-8dff-773b3b7d13ca" />

- This command saves results in 3 formats (normal, grep, XML).


#### 6. Banner Grabbing + NSE Aggression
````
rustscan -a 192.168.127.129 -- -sV --script=banner,vuln --version-all
````
<img width="894" height="765" alt="image" src="https://github.com/user-attachments/assets/5ed6c5a2-897c-48a5-9e24-86af846b778b" />

<img width="886" height="723" alt="image" src="https://github.com/user-attachments/assets/1e4d4bc5-f472-4c1b-96a0-6425e6ea6ad2" />

<img width="907" height="720" alt="image" src="https://github.com/user-attachments/assets/72829625-973a-4742-b856-000fb3a262d8" />

<img width="885" height="383" alt="image" src="https://github.com/user-attachments/assets/c23696c0-9414-4c27-bdd9-3cfc8cbb40e4" />

- `--script=banner` : Retrieves banners or welcome messages from services, providing additional clues about software (e.g., FTP banners, SSH versions).
- `--script=vuln` : Runs NSE scripts to detect known vulnerabilities, such as outdated software or misconfigurations.
- This command useful for fingerprinting old/weak services.



#### 7. Firewall/IDS Bypass with Decoys
````
rustscan -a 192.168.127.129 -- -sS -Pn -D RND:10
````
<img width="662" height="682" alt="image" src="https://github.com/user-attachments/assets/254cb61b-ac9a-4395-b2b5-14bf9bf62b95" />

<img width="751" height="721" alt="image" src="https://github.com/user-attachments/assets/961bd66f-ec0a-4d39-b94d-a6834484d8bd" />

<img width="506" height="555" alt="image" src="https://github.com/user-attachments/assets/8a7a30ac-2ae0-40a0-9936-e03b1849d9ff" />

- `-D RND:10` : send 10 random decoy IPs.
- This command will hides our real source in IDS logs.


#### 8. Distributed / Parallel Targets
````
rustscan -a 192.168.127.128,192.168.127.129,scanme.nmap.org --ulimit 10000 -- -sC -sV
````
<img width="743" height="765" alt="image" src="https://github.com/user-attachments/assets/174e80d1-82ed-4af5-9a82-23f250570ed3" />

<img width="777" height="741" alt="image" src="https://github.com/user-attachments/assets/24b88774-b50b-485c-be31-b314d4f94a19" />

<img width="808" height="708" alt="image" src="https://github.com/user-attachments/assets/b79020d5-d93e-4b04-ad30-0a6244d17e77" />

<img width="909" height="688" alt="image" src="https://github.com/user-attachments/assets/5dbf1dec-3a71-420a-81bf-477d7c714926" />

<img width="792" height="707" alt="image" src="https://github.com/user-attachments/assets/d2f7c813-14f7-4995-b2c1-7dd740936228" />

- This command is designed for multi-target network reconnaissance with detailed service and vulnerability analysis.


### 14. Python script
I used AI to assist me to write this script, to make it easy to use like:
````
#!/usr/bin/env python3

import subprocess
import argparse
import re
import sys
import os

GREEN = '\033[92m'
YELLOW = '\033[93m'
RED = '\033[91m'
BLUE = '\033[94m'
ENDC = '\033[0m'

def print_status(message, level="info"):
    """Print colorized status messages."""
    colors = {
        "info": BLUE,
        "success": GREEN,
        "warning": YELLOW,
        "error": RED
    }
    color = colors.get(level, "")
    print(f"{color}[*] {message}{ENDC}")

def check_tool_installed(tool_name):
    """Check if a command-line tool is installed."""
    try:
        subprocess.run([tool_name, "--version"], stdout=subprocess.PIPE, stderr=subprocess.PIPE, check=True)
        return True
    except (subprocess.CalledProcessError, FileNotFoundError):
        return False

def run_rustscan(target, quiet=False):
    """Run RustScan and return the output."""
    try:
        if quiet:
            cmd = ["rustscan", "-a", target, "--ulimit", "5000", "-q"]
        else:
            cmd = ["rustscan", "-a", target, "--ulimit", "5000"]
        
        result = subprocess.run(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True, check=True)
        return result.stdout
    except subprocess.CalledProcessError as e:
        print_status(f"RustScan failed: {e.stderr}", "error")
        sys.exit(1)

def extract_open_ports(rustscan_output):
    """Extract open ports from RustScan output using regex."""
    port_pattern = r"Open.*?:([0-9]+)"
    matches = re.findall(port_pattern, rustscan_output)
    return list(set(matches))  

def run_nmap(target, ports, script_scan=False, quiet=False):
    """Run Nmap on the given ports."""
    if not ports:
        print_status("No open ports to scan with Nmap.", "warning")
        return ""

    ports_str = ','.join(ports)
    cmd = ["nmap", "-p", ports_str, "-sV"]
    if script_scan:
        cmd.append("-sC")
    cmd.append(target)

    try:
        result = subprocess.run(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True, check=True)
        if not quiet:
            print(result.stdout)
        return result.stdout
    except subprocess.CalledProcessError as e:
        print_status(f"Nmap failed: {e.stderr}", "error")
        return ""

def save_output(filename, content):
    """Save content to a file."""
    try:
        with open(filename, 'w') as f:
            f.write(content)
        print_status(f"Output saved to {filename}", "success")
    except Exception as e:
        print_status(f"Failed to save file: {e}", "error")

def main():
    parser = argparse.ArgumentParser(description="Automate RustScan and optional Nmap follow-up.")
    parser.add_argument("target", help="Target IP address or domain (e.g., 192.168.1.10 or example.com)")
    parser.add_argument("-n", "--nmap", action="store_true", help="Run Nmap version scan on open ports")
    parser.add_argument("-s", "--script", action="store_true", help="Run Nmap script scan (implies --nmap)")
    parser.add_argument("-o", "--output", help="Save output to a file")
    parser.add_argument("-q", "--quiet", action="store_true", help="Suppress color and extra output")

    args = parser.parse_args()

    if args.script:
        args.nmap = True

    if not check_tool_installed("rustscan"):
        print_status("RustScan is not installed or not in PATH.", "error")
        print("Download: https://github.com/RustScan/RustScan")
        sys.exit(1)

    if args.nmap and not check_tool_installed("nmap"):
        print_status("Nmap is not installed or not in PATH.", "error")
        sys.exit(1)

    print_status(f"Starting scan on target: {args.target}")
    rustscan_output = run_rustscan(args.target, quiet=args.quiet)

    open_ports = extract_open_ports(rustscan_output)
    if open_ports:
        port_list = ', '.join(open_ports)
        print_status(f"Open ports found: {port_list}", "success")
    else:
        print_status("No open ports found.", "warning")

    full_output = f"Target: {args.target}\nOpen Ports: {', '.join(open_ports) if open_ports else 'None'}\n\nRustScan Output:\n{rustscan_output}\n"
    
    if args.output:
        save_output(args.output, full_output)

    nmap_output = ""
    if args.nmap and open_ports:
        print_status("Running Nmap scan on open ports...")
        nmap_output = run_nmap(args.target, open_ports, script_scan=args.script, quiet=args.quiet)
        if args.output and nmap_output:
            with open(args.output, 'a') as f:
                f.write("\nNmap Output:\n")
                f.write(nmap_output)

    if not args.quiet:
        print(f"{GREEN} Scan completed.{ENDC}")

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print_status("Scan interrupted by user.", "error")
        sys.exit(1)
````
- run script:
````
/home/k4n0ng/Documents/PYTHON_Program/venv/bin/python /home/k4n0ng/Documents/PYTHON_Program/rustscan.py 192.168.127.129
````
<img width="852" height="176" alt="image" src="https://github.com/user-attachments/assets/ed79967c-0328-4edc-81db-384b924a40ae" />

````
/home/k4n0ng/Documents/PYTHON_Program/venv/bin/python /home/k4n0ng/Documents/PYTHON_Program/rustscan.py 19.168.127.129 -n -s -o results.txt
````
<img width="849" height="364" alt="image" src="https://github.com/user-attachments/assets/bcd5eb17-a133-4a16-8cd5-0c423f636d26" />

- view file:
````
cat reults.txt
````
<img width="846" height="494" alt="image" src="https://github.com/user-attachments/assets/e91aa778-3cb0-4714-ad78-90220d3e97f7" />



### ============>>> End Of Rustscan


### why hacker use Rustscan:
Hackers (and pentesters) use RustScan because it solves a big problem: speed + stealth + automation.
- Speed : RustScan is much faster than Nmap because itâ€™s written in Rust.
- Stealth : Works with Nmapâ€™s stealth modes (SYN scan, decoys, slow timing, etc.).
- Subnet Sweeping : Hackers donâ€™t just scan one host â€” they scan entire networks to find weak devices.
- Service Enumeration : Hackers want to know whatâ€™s running (e.g., SSH, SMB, RDP, MySQL).



### Creditable:
1. https://github.com/bee-san/RustScan
2. https://www.hackingarticles.in/rustscan-network-scanner-detailed-guide/
3. https://www.geeksforgeeks.org/linux-unix/rustscan-faster-nmap-scanning-with-rust/
4. https://www.youtube.com/watch?v=99n3X2BX6Co



### Practice in LAB BY: Nin Kanong(k4n0ng)

#### Date: 1/Sept/2025
