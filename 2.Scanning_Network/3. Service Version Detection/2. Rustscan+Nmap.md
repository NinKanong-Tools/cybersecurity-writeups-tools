# Rustscan+Nmap Service version Detection

<img width="723" height="393" alt="2d47a1df670c8614c011d63e3701e033" src="https://github.com/user-attachments/assets/66ed9fd4-f74c-48e7-9014-efcefc768970" />


### What is Rustscan service version detection?
RustScan is a super-fast port scanner written in Rust. Find open ports quickly, faster than Nmap alone. It is lightweight and optimized, so it can scan all 65,535 TCP ports in seconds. RustScan does not detect service versions itself—it focuses only on finding open ports.


### LAB TOOLS:
- Kali Linux
- Metasploible2

## Usage:

### 1. Basic RustScan with Default Nmap Version Scan:
````
rustscan -a 192.168.127.129 --
````
<img width="895" height="524" alt="image" src="https://github.com/user-attachments/assets/06b3e1f3-8536-4514-8d67-a8c5a48d6871" />

<img width="837" height="392" alt="image" src="https://github.com/user-attachments/assets/11cf5976-7b90-4093-b167-acd406e12fdb" />

<img width="508" height="592" alt="image" src="https://github.com/user-attachments/assets/0c5c4e7f-0480-4648-ae58-d59fd8454c2d" />

- RustScan scans for open ports and pipes them to Nmap with default -sV.


### 2. RustScan with Specific Port and Version Scan:
````
rustscan -a 192.168.127.129 -p 80 --
````
<img width="893" height="706" alt="image" src="https://github.com/user-attachments/assets/2baf47ce-a8a2-4375-b6dd-6ec1e74b3df6" />

- Targets port 80 and runs Nmap -sV.


### 3. RustScan with Small Port Range and Version Scan:
````
rustscan -a 192.168.127.129 -r 1-100 --
````
<img width="905" height="732" alt="image" src="https://github.com/user-attachments/assets/178d6329-b0cb-411e-a444-0efa67c0780b" />

<img width="500" height="222" alt="image" src="https://github.com/user-attachments/assets/b72cd9cb-7434-48b5-a55f-0955ed466612" />

- this command will scans ports 1-100 and pipes to Nmap for version detection.


### 4. RustScan with Key Ports and Version Scan:
````
rustscan -a 192.168.127.129 -p 21,22,80,139,445 --
````
<img width="893" height="702" alt="image" src="https://github.com/user-attachments/assets/932c9eb6-25d7-4458-9581-cff238760f31" />

<img width="510" height="218" alt="image" src="https://github.com/user-attachments/assets/57696ff2-43cc-4d7b-acb5-2ddf11899167" />

- This command will targets Metasploitable2’s key ports (FTP, SSH, HTTP, SMB) for version detection.


### 5. RustScan with Faster Batch Size and Version Scan:
````
rustscan -a 192.168.127.129 -b 1000 --
````
<img width="750" height="506" alt="image" src="https://github.com/user-attachments/assets/29451ab6-0594-40c3-afaf-d564ce3c82cb" />

<img width="795" height="433" alt="image" src="https://github.com/user-attachments/assets/e939890a-2038-451a-8516-460aef5febe6" />

<img width="520" height="596" alt="image" src="https://github.com/user-attachments/assets/8f391197-dbbe-4a41-b9be-c45c606fe79d" />

- This command will increases batch size to 1000 for speed, pipes to Nmap -sV.


### 6. RustScan with Saved Nmap Output:
````
rustscan -a 192.168.127.129 -- -oN rustscan_nmap.txt
````
<img width="885" height="438" alt="image" src="https://github.com/user-attachments/assets/cefb86ae-a647-42f4-b83d-fc91dfaa1e23" />

<img width="867" height="357" alt="image" src="https://github.com/user-attachments/assets/6a8d2f64-610b-4126-88b0-10b06c4d0e29" />

<img width="520" height="594" alt="image" src="https://github.com/user-attachments/assets/8229f206-214a-4771-aed8-2f04b1278e01" />

- This command will saves Nmap -sV output to a text file.


### 7. RustScan with OS Detection:
````
rustscan -a 192.168.127.129 -- -O
````
<img width="630" height="408" alt="image" src="https://github.com/user-attachments/assets/553166ef-0959-4061-8c3a-ec140b1b6394" />

<img width="773" height="293" alt="image" src="https://github.com/user-attachments/assets/81c08583-dab9-4cdc-9fea-855e783c1f16" />

<img width="799" height="615" alt="image" src="https://github.com/user-attachments/assets/bd15b74b-48a5-46c6-917d-263e11af5229" />

<img width="741" height="372" alt="image" src="https://github.com/user-attachments/assets/5800313f-f3c9-4dbf-a09e-976d28e28156" />

- this command will use for pipes to Nmap with -sV and -O for OS fingerprinting.


### 8. RustScan with Skip Host Discovery:
````
rustscan -a 192.168.127.129 -- -Pn
````
<img width="685" height="328" alt="image" src="https://github.com/user-attachments/assets/82c1410c-8ba7-463e-bbd0-172e94fde231" />

<img width="553" height="702" alt="image" src="https://github.com/user-attachments/assets/459e9d69-df52-40a6-972c-8398cc6142c0" />

- This command will skips ping checks, useful if Metasploitable’s firewall blocks ICMP.


### 9. RustScan with Maximum Version Intensity:
````
rustscan -a 192.168.127.129 -- --version-intensity 9
````
<img width="558" height="635" alt="image" src="https://github.com/user-attachments/assets/b11519f4-c150-4175-b6e7-368ed07dd9ce" />

<img width="690" height="347" alt="image" src="https://github.com/user-attachments/assets/f36aa4ab-036b-4151-95d8-6f76d3a66ab3" />

<img width="505" height="593" alt="image" src="https://github.com/user-attachments/assets/044c612c-5d66-47f5-99a7-f008c0d22bd3" />

- This command will uses Nmap’s highest probe intensity for accuracy.


### 10. RustScan with Aggressive Scan:
````
rustscan -a 192.168.127.129 -- -A
````
<img width="885" height="411" alt="image" src="https://github.com/user-attachments/assets/0079a30c-186b-4092-81bb-d794c613734c" />

<img width="780" height="289" alt="image" src="https://github.com/user-attachments/assets/c93263c2-316d-439c-a075-ec0d4c874946" />

<img width="897" height="558" alt="image" src="https://github.com/user-attachments/assets/c5a4c30d-c709-41c0-b354-5d95cd51611d" />

<img width="788" height="725" alt="image" src="https://github.com/user-attachments/assets/13fef527-119b-4348-a3fa-025dd23589b9" />


- This command use for pipes to Nmap with -A ( -sV, -O, default scripts).


### 11. RustScan with Custom Timing:
````
rustscan -a 192.168.127.129 -- -T4
````
<img width="838" height="445" alt="image" src="https://github.com/user-attachments/assets/5498c30a-fb14-4c87-bb44-e6854e844b1e" />

<img width="743" height="408" alt="image" src="https://github.com/user-attachments/assets/4847aadd-6f7a-4cd1-accf-89508a453f8f" />

<img width="504" height="599" alt="image" src="https://github.com/user-attachments/assets/25d49f33-3796-4ac2-8c46-08c9144241b3" />

- This command will uses Nmap timing template 4 (aggressive) for speed.


### 12. RustScan with Default NSE Scripts:
````
rustscscan -a 192.168.127.129 -- -sC
````
<img width="882" height="532" alt="image" src="https://github.com/user-attachments/assets/dfc42863-6608-4279-96f8-1f2cb8a40b1b" />

<img width="726" height="294" alt="image" src="https://github.com/user-attachments/assets/e5cc0480-4c9f-4086-917a-a635d0ba6b53" />

<img width="761" height="455" alt="image" src="https://github.com/user-attachments/assets/fc9757aa-5970-4a31-af89-1abee9e7743e" />

<img width="626" height="387" alt="image" src="https://github.com/user-attachments/assets/3b87a142-68c8-4f92-a59c-cc6e51e07a7f" />


### 13. RustScan with HTTP Enum Script:
````
rustscan -a 192.168.127.129 -p 80 -- --script http-enum
````
<img width="898" height="762" alt="image" src="https://github.com/user-attachments/assets/af1777e9-0630-4b8b-9650-36bd77a62cb4" />

<img width="740" height="326" alt="image" src="https://github.com/user-attachments/assets/0bb674b2-9771-43f9-8898-6d592b01d85e" />

- this command will enumerates web app details on port 80.


### 14. RustScan with Multiple Output Formats:
````
rustscan -a 192.168.127.129 -- -oA rustscan_nmap_scan
````
<img width="869" height="542" alt="image" src="https://github.com/user-attachments/assets/8e683ae9-8ade-4823-acf3-ff3dfbbd3d42" />

<img width="892" height="339" alt="image" src="https://github.com/user-attachments/assets/23208791-98b0-40d8-8318-28c917a5e27e" />

<img width="519" height="602" alt="image" src="https://github.com/user-attachments/assets/c9118c1a-696f-4931-bd02-b1b6959c169a" />

- Check file:
````
cat rustscan_nmap_scan.nmap
````
<img width="838" height="721" alt="image" src="https://github.com/user-attachments/assets/14aea155-bcd0-49d7-8204-6a5158ab20b7" />

-  In this it saves as rustscan_nmap_scan.nmap, .gnmap, and .xml.


### 15. RustScan with XML Output:
````
rustscan -a 192.168.127.129 -- -oX rustscan_nmap.xml
````
<img width="887" height="515" alt="image" src="https://github.com/user-attachments/assets/ecd194d5-ef33-456b-a9a8-d06f63924d80" />

<img width="879" height="396" alt="image" src="https://github.com/user-attachments/assets/bd2e6359-bd0b-4e71-ae50-e3ea6f0876e9" />

<img width="507" height="605" alt="image" src="https://github.com/user-attachments/assets/702726f5-2216-4a79-8bc5-bc612a635740" />

- Check file:
````
cat rustscan_nmap.xml
````
<img width="909" height="650" alt="image" src="https://github.com/user-attachments/assets/483e5a5d-1238-42c4-adb6-41bb0952b2b3" />

- This command will produces XML for automation.


### 16. RustScan with Debug Mode:
````
rustscan -a 192.168.127.129 -- --packet-trace
````
<img width="876" height="548" alt="image" src="https://github.com/user-attachments/assets/389ab6c4-2dc8-4350-8db3-10be03d008ec" />

<img width="896" height="624" alt="image" src="https://github.com/user-attachments/assets/7b118664-9441-4406-a771-af2f1afeb272" />

<img width="534" height="592" alt="image" src="https://github.com/user-attachments/assets/42b9f20a-1b97-403e-b897-aaa6ac873ff7" />



### =============>>> End Of Rustscan+Nmap Service version detection

### Why hacker use rustscan+Nmap:
Hacker use rustscan + nmap because it easy to use:
- Speed : RustScan quickly scans all 65,535 TCP ports in seconds, much faster than Nmap alone.
- Efficiency : Instead of scanning every port with Nmap (slow), RustScan finds only open ports, saving time and resources.
- Accurate service detection : After RustScan finds open ports, Nmap (-sV) performs detailed service/version detection on only the open ports.
- Automation : RustScan can automatically pipe results to Nmap, streamlining the scanning process.


### Credits:
1. https://www.youtube.com/watch?v=UXVppfH8vEc
2. https://www.youtube.com/watch?v=99n3X2BX6Co&t=368s
3. https://www.geeksforgeeks.org/linux-unix/rustscan-faster-nmap-scanning-with-rust/


### Practice in LAB BY: Nin anong(k4n0ng)

#### Date: 1/Sept/2025
