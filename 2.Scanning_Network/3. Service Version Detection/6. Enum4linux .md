# Enum4linux

<img width="1280" height="720" alt="1_RxB1Xk6rIgpL8BB8XljcQg" src="https://github.com/user-attachments/assets/17b67045-01ac-4827-86cf-861bde7e1470" />

### What is enum4linux?
enum4linux is a tool to enumerate Windows machines via SMB (TCP/445).
  - It extracts:
  - OS and service version
  - NetBIOS/SMB info
  - Domain/workgroup info
  - Shares, users, and more

### LAB TOOLS:
- Kali Linux
- Metasploitable2


## Usage:
#### Get help:
````
enum4linux -h
````
<img width="805" height="733" alt="image" src="https://github.com/user-attachments/assets/86f02446-b0c1-4623-9886-c87e45c5b8f7" />

#### Enum4Linux for service version detection:
| **Option** | **Description**                                       | **Use for Service/Version Detection**                                  |
| ---------- | ----------------------------------------------------- | ---------------------------------------------------------------------- |
| `-o`       | Get OS information                                    | Detects the operating system version running on the target             |
| `-i`       | Get printer information                               | Sometimes reveals printer service versions and drivers                 |
| `-n`       | Do an nmblookup (NetBIOS)                             | Can return NetBIOS version/workgroup info                              |
| `-a`       | Do all simple enumeration (`-U -S -G -P -r -o -n -i`) | Includes OS and NetBIOS info (so indirectly service version detection) |
| `-v`       | Verbose mode                                          | Shows full commands & may leak extra version strings                   |

### 1. Basic command
````
enum4linux 192.168.127.129
````
<img width="813" height="467" alt="image" src="https://github.com/user-attachments/assets/8df92e22-dc57-4b60-9557-11a209732e9c" />

### 1. Basic OS/Service Version Detection
````
enum4linux -o 192.168.127.129
````
<img width="833" height="627" alt="image" src="https://github.com/user-attachments/assets/4eff1e62-af1c-4a59-acaa-17d643ba4943" />

- `-o` : detects OS version and service pack.


### 2. Verbose Scan (includes version info)
````
enum4linux -v 192.168.127.129
````
<img width="811" height="697" alt="image" src="https://github.com/user-attachments/assets/994ec99a-62b1-4578-b96b-2c97a46a63a0" />

<img width="847" height="380" alt="image" src="https://github.com/user-attachments/assets/9506036f-e436-4414-9863-8007e8d6ff6b" />

<img width="889" height="315" alt="image" src="https://github.com/user-attachments/assets/9e95c42b-6211-4837-9b1b-a249d0f91eff" />

<img width="852" height="477" alt="image" src="https://github.com/user-attachments/assets/4442267e-a049-4e2a-b764-6942ef72bdb9" />

- `-v` : prints extra detail, including service version in banners.
- This command use to perform detailed enumeration against the target system at IP address 192.168.127.129.


### 3. Simple Null Session (quick version grab)
````
enum4linux -n 192.168.127.129
````
<img width="792" height="622" alt="image" src="https://github.com/user-attachments/assets/1cde7128-7026-40b0-bc1b-bc843192e824" />

- `-n` : disables NetBIOS name lookups.
- Still leaks SMB/OS version if banners are exposed.
- This command uses to perform NetBIOS enumeration against the target system at IP address 192.168.127.129.


### 4. All Enumeration (includes version detection)
````
enum4linux -a 192.168.127.129
````
<img width="793" height="728" alt="image" src="https://github.com/user-attachments/assets/1b228d9a-9508-4f9e-85ce-8fdd1de6adb7" />

<img width="791" height="327" alt="image" src="https://github.com/user-attachments/assets/a8902968-9336-4fe0-a0eb-9a575a83ef09" />

<img width="737" height="376" alt="image" src="https://github.com/user-attachments/assets/ae99bdc7-8e5c-48ab-a142-480770d11cff" />

<img width="763" height="556" alt="image" src="https://github.com/user-attachments/assets/3478e7ff-bbb1-427a-8618-2b48b7cda309" />

- `-a` : run all options (users, shares, and OS version detection).
- This command runs to performs all common enumeration checks against the target system at 192.168.127.129.


### 5. Workgroup/Domain Info (sometimes leaks version)
````
enum4linux -U 192.168.127.129
````
<img width="797" height="491" alt="image" src="https://github.com/user-attachments/assets/140d6444-42ee-4aa1-a492-da51868f1ddd" />

<img width="775" height="238" alt="image" src="https://github.com/user-attachments/assets/c16cdaeb-5900-44c8-9baa-ec0704274451" />

<img width="452" height="561" alt="image" src="https://github.com/user-attachments/assets/a1672744-989b-46a9-992f-614e3923ab14" />

- `-U` : gets domain/workgroup info.
- This command uses to enumerate user accounts on the target system at 192.168.127.129.


### 6. Detailed Server Info (SMB/NetBIOS version)
````
enum4linux -i 192.168.127.129
````
<img width="795" height="612" alt="image" src="https://github.com/user-attachments/assets/49476e06-08d5-4438-8200-16b3c1e64548" />

- `-i` : shows detailed server information, including NetBIOS, domain, and SMB version.
- This command uses to retrieve share information from the target system at 192.168.127.129.


### 7. RID Cycling (can reveal version/build info)
````
enum4linux -r 192.168.127.129
````
<img width="795" height="724" alt="image" src="https://github.com/user-attachments/assets/ebd7558e-e9b4-4791-847d-3e0d9b2d536f" />

<img width="765" height="587" alt="image" src="https://github.com/user-attachments/assets/0b8f48b3-eb25-4cba-a975-a7fb39739c07" />

- `-r` : RID cycle enumeration.
- This command uses to perform RID (Relative Identifier) cycling, attempting to enumerate user and group accounts on the target system at 192.168.127.129 by querying via their Security Identifiers (SIDs). 


### 8. Combine with SMB Client (confirm version)
````
smbclient -L //192.168.127.129/ -N
````
<img width="655" height="318" alt="image" src="https://github.com/user-attachments/assets/f841e0bd-b886-4b73-915c-fc63d9a44bef" />

- Hackers often run this after enum4linux to confirm the SMB service version.
- `-L` : tells smbclient to query the target and list all shared resources (such as file shares or printers).
- `-N` : means no password prompt it will not ask for a password and will attempt to connect without authentication (useful for checking anonymous access).

## Enum4linux
 enum4linux-ng (a modern rewrite of enum4linux).
- first we need to install it:
````
enum4linux-ng
````
<img width="863" height="142" alt="image" src="https://github.com/user-attachments/assets/b8dfbf8d-5b83-4edc-b299-52afaf1e7de1" />

- In this i was install it. But if we have not install just type `enum4linux-ng` and type `y` and type password, it will install.

### 1. Use enum4linux-ng (modern fork)

````
enum4linux-ng -A 192.168.127.129
````
<img width="501" height="588" alt="image" src="https://github.com/user-attachments/assets/adc8c26a-7904-4f1d-aaec-0da240738297" />

<img width="441" height="522" alt="image" src="https://github.com/user-attachments/assets/d970bc60-628b-4daf-8433-c97fd5c7dbb5" />

<img width="597" height="379" alt="image" src="https://github.com/user-attachments/assets/ead132fc-b612-418e-a05d-83893467b797" />

<img width="442" height="445" alt="image" src="https://github.com/user-attachments/assets/51778567-f96c-4411-93a6-3efa5bb4c441" />

<img width="511" height="616" alt="image" src="https://github.com/user-attachments/assets/8497077a-b55c-44dd-b1e0-028039bb14e5" />

- `-A` : all enumeration (includes service version & OS).
- This command use to perform all available enumeration checks against the target system at 192.168.127.129.


### 2. Specify SMB Protocol
````
smbclient -L //192.168.127.129/ -N --option='client min protocol=NT1'
````
<img width="679" height="315" alt="image" src="https://github.com/user-attachments/assets/aa951584-bcd6-434f-b1bd-8732a850c760" />


### 3. Chain with smbclient for banner grabbing
````
smbclient -L //192.168.127.129/ -N -d 3
````
<img width="863" height="632" alt="image" src="https://github.com/user-attachments/assets/40e4bcee-87db-4f96-ac64-9e6f2ea6cdc1" />

<img width="854" height="515" alt="image" src="https://github.com/user-attachments/assets/256d8dc6-9962-4b28-bb77-df355f339051" />

- `-d 3` : debug level 3 → prints SMB protocol negotiation with version.
- `-N` : means no password prompt it will connect without authentication (anonymous or null session).


### 4. Combine with nmap service detection
````
nmap -p 139,445 --script smb-os-discovery 192.168.127.129
````
<img width="484" height="329" alt="image" src="https://github.com/user-attachments/assets/f500639e-fc3d-4a81-bdb5-790b857e4a97" />

- This command it will gives Windows version + build number.
- Hackers often run enum4linux first, then confirm with Nmap.


### 5. RID Cycling with Verbose Output
````
enum4linux -r -v 192.168.127.129
````
<img width="809" height="456" alt="image" src="https://github.com/user-attachments/assets/3342c55a-050c-4012-bb6f-5e1ebe56f940" />

<img width="768" height="594" alt="image" src="https://github.com/user-attachments/assets/c22b2be8-77ae-4ebf-8e68-13c6aa73dc35" />

- Sometimes Windows RID responses leak build/version metadata.
- `-r` : enables RID cycling, a technique that queries the target using sequential Relative Identifiers to discover user and group accounts by attempting to resolve their Security Identifiers (SIDs).
- `-v` : enables verbose mode, which displays detailed information about each step of the enumeration process, including connections, queries, and responses from the target.


### 6. Extract NetBIOS version manually
````
nbtscan -v 192.168.127.129
````
<img width="404" height="396" alt="image" src="https://github.com/user-attachments/assets/e161f0ef-6a5b-44c7-8d9b-25687676e8a9" />

- In this it works in combination with enum4linux.
- And it will prints NetBIOS version, hostname, and workgroup.


### 7. Enumerate SMB signing & dialects (service fingerprinting)
````
enum4linux-ng -S 192.168.127.129
````
<img width="479" height="739" alt="image" src="https://github.com/user-attachments/assets/25b24918-227c-4e91-b7bc-4a952505760c" />

<img width="537" height="603" alt="image" src="https://github.com/user-attachments/assets/1d37a74a-ec44-47d4-9f84-3c97e43db623" />

- `-S` : SMB security checks.
- Reveals if SMB signing is enabled (important for MITM attacks) and which dialect versions are accepted.


### 8. Banner grab with smbclient
````
smbclient -L //192.168.127.129/ -N -d 3
````
<img width="859" height="636" alt="image" src="https://github.com/user-attachments/assets/13b3dd35-c04b-4b4b-a6f0-3a43a9e99c2a" />

<img width="861" height="511" alt="image" src="https://github.com/user-attachments/assets/b5c6d266-bb08-48a6-8f48-a96ba17dd660" />

- In this command confirms: Using SMB1 → vulnerable to EternalBlue

### =============>>> End Of Enum4linux


### Why hacker use enum4linux
Hackers (and penetration testers) use enum4linux for service version detection because knowing the exact OS and SMB version is the key to choosing the right exploit.
- Identify Windows/SMB version
- Match versions to known exploits
- Reconnaissance without credentials
- Find legacy/weak services
- Prepare for privilege escalation

####  How hacker use enum4linux:
- I will show example:

=> Hacker runs:
````
enum4linux -o 192.168.127.1
````
- Output:
OS = Windows 6.1 (Build 7601: Service Pack 1)
SMBv1 supported

=> Hacker thinks:
   - Windows 6.1 → Windows 7 SP1
   - SMBv1 → check MS17-010 EternalBlue exploit.

=> Hacker loads exploit in Metasploit or custom script.



### 



### PRACTICE IN LAB BY: NIN KANONG(k4n0ng)

#### Date: 2/Sept/2025
